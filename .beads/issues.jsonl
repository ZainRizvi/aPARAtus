{"id":"para_plugin-090","title":"Remove unused TFile import and clarify archiving scope","description":"## Problem\nsrc/main.ts:1 imports TFile but the code intentionally handles TAbstractFile generically now. The import is used in the instanceof check on line 92.\n\nLooking at the code:\n```typescript\nif (!(file instanceof TFolder) \u0026\u0026 !(file instanceof TFile)) {\n  return;\n}\n```\n\nThis allows archiving both folders AND files. This appears intentional (method renamed to archiveItem), but need to confirm the check is correct.\n\n## Analysis\nThe check should be: allow TFolder and TFile (which are the concrete types). TAbstractFile is abstract.\nCurrent code is correct - it filters out anything that's not a folder or file.\n\n## Verdict\nThe import IS used on line 92. No change needed for the import.\n\nHowever, the original spec said 'folders only'. If files should NOT be archivable, change line 92 to:\n```typescript\nif (!(file instanceof TFolder)) {\n  return;\n}\n```\n\nAnd remove TFile from imports.\n\n## Decision Needed\nThis is a feature scope question. For now, KEEP the current behavior (files archivable) since:\n1. The code was deliberately refactored to use archiveItem\n2. It's a superset of functionality\n3. README will be updated to reflect this\n\nMark this task as 'wont-fix' - behavior is intentional.\n\n## Files\n- src/main.ts (no change needed)","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T13:50:10.529488-06:00","created_by":"zain","updated_at":"2026-01-06T13:50:19.764141-06:00","closed_at":"2026-01-06T13:50:19.764141-06:00","close_reason":"Intentional behavior - files are archivable by design. README being updated to reflect this."}
{"id":"para_plugin-2f3","title":"Add support for archiving Areas and Resources (full PARA)","description":"## Feature\nExtend the plugin to support archiving from all PARA source folders, not just Projects.\n\n## Current State\n- Only `projectsPath` (default: 'Projects') is supported\n- Context menu and commands only work on items in Projects folder\n\n## Desired State\nSupport three source folders:\n- `projectsPath` (default: 'Projects') - existing\n- `areasPath` (default: 'Areas') - new\n- `resourcesPath` (default: 'Resources') - new\n\nAll three should be archivable to the single `archivePath` (default: 'Archive').\n\n## Changes Required\n\n### 1. Update Settings Interface (`src/settings.ts`)\n\n```typescript\nexport interface ArchiveProjectSettings {\n  projectsPath: string;\n  areasPath: string;      // NEW\n  resourcesPath: string;  // NEW\n  archivePath: string;\n  focusAfterArchive: boolean;\n  confirmBeforeArchive: boolean;\n}\n\nexport const DEFAULT_SETTINGS: ArchiveProjectSettings = {\n  projectsPath: 'Projects',\n  areasPath: 'Areas',           // NEW\n  resourcesPath: 'Resources',   // NEW\n  archivePath: 'Archive',\n  focusAfterArchive: true,\n  confirmBeforeArchive: false,\n};\n```\n\n### 2. Add Settings UI (`src/settings.ts`)\n\nAdd two new text inputs for areasPath and resourcesPath, with same validation pattern as existing paths (can't match archivePath or each other).\n\n### 3. Update Context Menu (`src/main.ts`)\n\nChange the file-menu handler to check if item is direct child of ANY source folder:\n\n```typescript\nthis.registerEvent(\n  this.app.workspace.on('file-menu', (menu, file) =\u003e {\n    if (!(file instanceof TFolder) \u0026\u0026 !(file instanceof TFile)) {\n      return;\n    }\n\n    const sourceFolders = this.getSourceFolders();\n    const isTopLevel = sourceFolders.some(src =\u003e \n      isTopLevelProjectFolder(file.path, src)\n    );\n    \n    if (!isTopLevel) return;\n\n    menu.addItem((item) =\u003e {\n      item.setTitle('Archive it').setIcon('archive').onClick(async () =\u003e {\n        await this.archiveItem(file);\n      });\n    });\n  })\n);\n```\n\n### 4. Add Helper Method (`src/main.ts`)\n\n```typescript\nprivate getSourceFolders(): string[] {\n  return [\n    normalizePath(this.settings.projectsPath),\n    normalizePath(this.settings.areasPath),\n    normalizePath(this.settings.resourcesPath),\n  ].filter(Boolean); // Filter out empty strings\n}\n```\n\n### 5. Update Settings Validation\n\nIn `loadSettings()` and settings onChange handlers, validate that:\n- No two source folders are the same\n- No source folder matches archivePath\n\n### 6. Update focusProjectsFolder\n\nConsider renaming to `focusSourceFolder` and making it focus the appropriate source folder based on where the item came from. Or keep simple and always focus projectsPath.\n\n## Dependencies\n- Should implement after para_plugin-rdh and para_plugin-vx8 (commands) since they set up `getSourceFolders()` pattern\n\n## Files\n- src/settings.ts (interface, defaults, UI)\n- src/main.ts (context menu, helper method, validation)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-06T13:41:27.304579-06:00","created_by":"zain","updated_at":"2026-01-06T14:22:54.503402-06:00","closed_at":"2026-01-06T14:22:54.503402-06:00","close_reason":"Full PARA support implemented (Projects, Areas, Resources)","dependencies":[{"issue_id":"para_plugin-2f3","depends_on_id":"para_plugin-rdh","type":"blocks","created_at":"2026-01-06T13:41:34.614756-06:00","created_by":"zain"},{"issue_id":"para_plugin-2f3","depends_on_id":"para_plugin-vx8","type":"blocks","created_at":"2026-01-06T13:41:34.651247-06:00","created_by":"zain"}]}
{"id":"para_plugin-4ja","title":"Extract ArchiveConfirmModal to src/modals.ts","description":"## Problem\nmain.ts is 462 lines and does too much. The ArchiveConfirmModal class (~68 lines) is self-contained UI code that can be extracted.\n\n## Solution\nCreate src/modals.ts and move ArchiveConfirmModal there. This prepares for creation command modals that will also go in this file.\n\n## Changes\n1. Create src/modals.ts\n2. Move ArchiveConfirmModal class (lines 17-85)\n3. Export the modal class\n4. Update main.ts to import from modals.ts\n\n**Files likely modified**: src/main.ts, src/modals.ts (new)","status":"closed","priority":2,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T16:28:43.524788-06:00","created_by":"zain","updated_at":"2026-01-06T16:29:33.488847-06:00","closed_at":"2026-01-06T16:29:33.488847-06:00","close_reason":"Extracted ArchiveConfirmModal to src/modals.ts. main.ts reduced from 462 to 393 lines."}
{"id":"para_plugin-4k7","title":"Support archiving files, not just folders","description":"## Current Behavior\nThe plugin only shows 'Archive it' context menu for folders. In `src/main.ts:65`:\n\n```typescript\nif (!(file instanceof TFolder)) {\n  return;\n}\n```\n\n## Desired Behavior\nShould support archiving both files AND folders that are direct children of projectsPath.\n\n## Changes Required\n\n1. **main.ts:65** - Check for TFolder OR TFile:\n```typescript\nimport { Modal, Notice, Plugin, TAbstractFile, TFile, TFolder, normalizePath } from 'obsidian';\n\n// In file-menu handler:\nif (!(file instanceof TFolder) \u0026\u0026 !(file instanceof TFile)) {\n  return;\n}\n```\n\n2. **main.ts:100** - Update archiveFolder signature to accept TAbstractFile:\n```typescript\nasync archiveFolder(file: TAbstractFile): Promise\u003cvoid\u003e {\n```\n(Consider renaming to `archiveItem` for clarity)\n\n3. **utils.ts:isTopLevelProjectFolder** - Already works for any path, no change needed\n\n4. **Naming** - Consider renaming throughout:\n   - `archiveFolder` → `archiveItem`\n   - `folderName` → `itemName`\n   - Variable names referencing 'folder'\n\n5. **UI text** - Update menu item and notices to say 'item' or detect type:\n   - 'Archive it' (current, generic - OK)\n   - Notice could say 'Archived file' vs 'Archived folder'\n\n## Files\n- src/main.ts:1 (imports)\n- src/main.ts:65 (type check)\n- src/main.ts:100+ (archiveFolder method and callers)\n- Possibly rename functions/variables throughout","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-06T13:26:50.795477-06:00","created_by":"zain","updated_at":"2026-01-06T13:33:18.061607-06:00","closed_at":"2026-01-06T13:33:18.061607-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-5rg","title":"Clean up modal keyboard event listener on close","description":"## Problem\nIn `src/main.ts:70`, the `ArchiveConfirmModal` adds a keydown event listener but never removes it in `onClose()`:\n\n```typescript\nonOpen() {\n  // ...\n  const handleKeydown = (e: KeyboardEvent) =\u003e { ... };\n  contentEl.addEventListener('keydown', handleKeydown);\n}\n\nonClose() {\n  const { contentEl } = this;\n  contentEl.empty();\n  // No removeEventListener!\n}\n```\n\n## Impact\nWhile Obsidian likely cleans up the DOM and its listeners, explicitly removing listeners is better practice and prevents potential memory leaks if the modal is opened/closed many times.\n\n## Fix\nStore the handler reference as a class property and remove it in onClose:\n\n```typescript\nprivate keydownHandler?: (e: KeyboardEvent) =\u003e void;\n\nonOpen() {\n  // ...\n  this.keydownHandler = (e: KeyboardEvent) =\u003e { ... };\n  contentEl.addEventListener('keydown', this.keydownHandler);\n}\n\nonClose() {\n  if (this.keydownHandler) {\n    this.contentEl.removeEventListener('keydown', this.keydownHandler);\n  }\n  this.contentEl.empty();\n  // ...\n}\n```\n\n## Files\n- src/main.ts:16-80 (ArchiveConfirmModal class)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-06T14:16:29.087859-06:00","created_by":"zain","updated_at":"2026-01-06T14:19:19.099815-06:00","closed_at":"2026-01-06T14:19:19.099815-06:00","close_reason":"Event listener cleanup implemented"}
{"id":"para_plugin-5wn","title":"Reduce redundant path normalization","description":"## Problem\nPaths get normalized multiple times throughout the codebase:\n\n1. In `src/settings.ts:36,49` - paths are trimmed and trailing slashes removed on save\n2. In `src/main.ts:31,59,140` - paths are normalized again with Obsidian's `normalizePath()`\n3. In `src/utils.ts:39-40,73` - paths are normalized again with `normalizePathPure()`\n\n## Impact\n- Minor performance overhead (negligible for this use case)\n- Code noise and potential confusion about which normalization is authoritative\n- If normalizers diverge in behavior, subtle bugs could occur\n\n## Suggested Fix\nNormalize once at settings load/save time, then trust the stored value is normalized:\n\n1. Keep the `trim().replace(/\\/+$/, '')` in settings onChange\n2. Remove redundant `normalizePath()` calls in main.ts where value comes from settings\n3. Update `isTopLevelProjectFolder` to document that it expects pre-normalized paths, OR remove its internal normalization\n\n## Files\n- src/settings.ts:36,49\n- src/main.ts:31,59,140\n- src/utils.ts:39-40,73","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-06T13:12:42.397049-06:00","created_by":"zain","updated_at":"2026-01-06T13:19:06.573446-06:00","closed_at":"2026-01-06T13:19:06.573446-06:00","close_reason":"Documented instead of removing - defense in depth"}
{"id":"para_plugin-6au","title":"Add optional confirmation dialog before archiving","description":"## Problem\nArchiving is a one-click action with no confirmation. While reversible (manually move folder back), users might accidentally archive a project.\n\n## User Story\nAs a user, I want to optionally see a confirmation dialog before archiving, so that I don't accidentally archive important projects.\n\n## Suggested Implementation\n1. Add a new setting `confirmBeforeArchive: boolean` (default: false to preserve current behavior)\n2. In `archiveFolder()`, check the setting and show a modal if enabled\n3. Use Obsidian's `Modal` class for the confirmation dialog\n4. Dialog should show: project name, destination path, and confirm/cancel buttons\n\n## Alternative: Undo Notice\nInstead of confirmation, could show a Notice with an 'Undo' button that has a ~5 second timeout. This is less intrusive but more complex to implement (need to track the move and reverse it).\n\n## Files to Modify\n- src/settings.ts - add new setting\n- src/main.ts - add confirmation modal logic\n\n## Acceptance Criteria\n- [ ] New toggle in settings: 'Confirm before archiving'\n- [ ] When enabled, shows modal with project name and destination\n- [ ] Can cancel to abort archive\n- [ ] When disabled, archives immediately (current behavior)","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-06T13:13:03.782642-06:00","created_by":"zain","updated_at":"2026-01-06T13:20:32.517642-06:00","closed_at":"2026-01-06T13:20:32.517642-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-6tm","title":"Extract settings validation helper to reduce duplication","description":"## Problem\nThe settings.ts file has ~120 lines of nearly identical validation logic repeated 4 times (once for each PARA folder setting). Each setting checks:\n- Equality against 3 other folders (3 checks)\n- Nesting against 3 other folders (3 checks)\n\n## Solution\nExtract a reusable `validateFolderPath()` helper that:\n1. Takes the new value, field being changed, and current settings\n2. Returns null if valid, or error message string if invalid\n3. Handles all equality and nesting checks in one place\n\n## Expected Result\n- ~120 lines reduced to ~30\n- Easier to add new folder settings in future\n- Same validation behavior\n\n**Files likely modified**: src/settings.ts, possibly src/utils.ts","status":"closed","priority":2,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T16:24:40.571673-06:00","created_by":"zain","updated_at":"2026-01-06T16:26:17.055004-06:00","closed_at":"2026-01-06T16:26:17.055004-06:00","close_reason":"Extracted validateParaFolderPath() helper. Reduced settings.ts from 239 to 186 lines (-22%). Same validation behavior, easier to add new settings."}
{"id":"para_plugin-73r","title":"Confirmation dialog shows path that might change on retry","description":"## Problem\nIn `src/main.ts:113-126`, the confirmation dialog shows `destPath` before archiving:\n\n```typescript\nconst destPath = generateArchiveDestination(...);\n\nif (this.settings.confirmBeforeArchive) {\n  new ArchiveConfirmModal(this.app, folderName, destPath, async () =\u003e {\n    await this.performArchive(folder, destPath, folderName, archivePath);\n  }).open();\n}\n```\n\nBut in `performArchive`, if rename fails due to case-insensitive collision, `destPath` gets regenerated:\n\n```typescript\ndestPath = generateArchiveDestination(archivePath, folderName, refreshedPaths);\n```\n\nUser sees 'Move to Archive/Foo' but might end up at 'Archive/Foo (Archived 2024-01-06)'.\n\n## Impact\nMinor UX confusion in edge case (case-insensitive collision after confirmation shown).\n\n## Possible Fixes\n1. **Accept it** - Very rare edge case, notice shows correct final path\n2. **Show notice if changed**: \n   ```typescript\n   if (finalPath !== originalDestPath) {\n     new Notice(`Note: Archived to ${finalPath} (destination changed due to conflict)`);\n   }\n   ```\n3. **Recalculate after confirm** - More complex, defeats pre-calculation purpose\n\nRecommend option 1 or 2.\n\n## Files\n- src/main.ts:113-126, 141-159","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-06T13:27:05.474241-06:00","created_by":"zain","updated_at":"2026-01-06T13:36:51.567808-06:00","closed_at":"2026-01-06T13:36:51.567808-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-77f","title":"Add keyboard accessibility to confirmation modal","description":"## Problem\nThe confirmation modal in `src/main.ts:28-44` lacks keyboard accessibility:\n- No focus management (confirm button should be focused)\n- No Enter key to confirm\n- Tab order not explicitly set\n\n## Suggested Fix\nIn `onOpen()`:\n\n```typescript\nonOpen() {\n  const { contentEl } = this;\n  contentEl.createEl('h2', { text: 'Archive Project?' });\n  contentEl.createEl('p', { text: `Move \"${this.folderName}\" to:` });\n  contentEl.createEl('p', { text: this.destPath, cls: 'archive-dest-path' });\n\n  const buttonContainer = contentEl.createDiv({ cls: 'modal-button-container' });\n\n  const cancelBtn = buttonContainer.createEl('button', { text: 'Cancel' });\n  cancelBtn.addEventListener('click', () =\u003e this.close());\n\n  const confirmBtn = buttonContainer.createEl('button', { text: 'Archive', cls: 'mod-cta' });\n  confirmBtn.addEventListener('click', () =\u003e {\n    this.onConfirm();\n    this.close();\n  });\n\n  // Focus confirm button for keyboard users\n  confirmBtn.focus();\n\n  // Handle Enter key\n  this.contentEl.addEventListener('keydown', (e) =\u003e {\n    if (e.key === 'Enter') {\n      this.onConfirm();\n      this.close();\n    }\n  });\n}\n```\n\n## Files\n- src/main.ts:28-44","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-01-06T13:27:41.064461-06:00","created_by":"zain","updated_at":"2026-01-06T13:36:09.10133-06:00","closed_at":"2026-01-06T13:36:09.10133-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-8vt","title":"ensureFolderExists should verify path is actually a folder","description":"## Problem\nIn `src/main.ts:109-117`, the `ensureFolderExists()` method checks if something exists at the path, but doesn't verify it's actually a folder:\n\n```typescript\nprivate async ensureFolderExists(folderPath: string): Promise\u003cvoid\u003e {\n  const folder = this.app.vault.getAbstractFileByPath(folderPath);\n  if (!folder) {\n    await this.app.vault.createFolder(folderPath);\n  }\n}\n```\n\n## Impact\nIf a user has a FILE named 'Archive' instead of a folder, this method returns without error. Then `vault.rename()` fails with a confusing error when trying to move the project into it.\n\n## Fix\nAdd an `instanceof TFolder` check and throw a clear error:\n\n```typescript\nif (!folder) {\n  await this.app.vault.createFolder(folderPath);\n} else if (!(folder instanceof TFolder)) {\n  throw new Error(`\"${folderPath}\" exists but is not a folder`);\n}\n```\n\n## Files\n- src/main.ts:109-117","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T13:11:42.495697-06:00","created_by":"zain","updated_at":"2026-01-06T13:15:31.331695-06:00","closed_at":"2026-01-06T13:15:31.331695-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-93v","title":"Add nested path validation for PARA folders","description":"## Problem\nSettings validation doesn't check if PARA folders are nested within each other. This can cause unexpected behavior:\n- `archivePath = \"Projects/Archive\"` would archive items inside the source folder\n- `projectsPath = \"Work/Projects\"` with `archivePath = \"Work\"` archives to parent of source\n\n## Current State\n- `loadSettings()` in `src/main.ts:126-152` only checks if folders match exactly\n- Settings tab in `src/settings.ts:41-118` validates on change but only for exact matches\n\n## Required Fix\nBlock ALL nested path configurations. All four PARA folders (Projects, Areas, Resources, Archive) must be non-nested with each other.\n\nAdd validation that checks:\n1. No folder is a parent of another (e.g., \"Work\" and \"Work/Projects\")\n2. No folder is a child of another\n\n## Acceptance Criteria\n- [ ] Add `isNestedPath(path1, path2)` utility function\n- [ ] Validate in settings tab onChange handlers\n- [ ] Validate in loadSettings() with reset to defaults if invalid\n- [ ] Show clear error message explaining why configuration is invalid\n- [ ] Unit tests for nested path detection","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T15:17:14.511342-06:00","created_by":"zain","updated_at":"2026-01-06T15:26:58.922666-06:00","closed_at":"2026-01-06T15:26:58.922666-06:00","close_reason":"Implemented via parallel sub-agents. All 43 tests pass, typecheck/lint/build all succeed.","comments":[{"id":6,"issue_id":"para_plugin-93v","author":"zain","text":"Starting implementation of nested path validation. Plan: 1) Add isNestedPath and arePathsNested utilities, 2) Update settings.ts validation, 3) Update loadSettings in main.ts, 4) Add unit tests","created_at":"2026-01-06T21:20:57Z"},{"id":7,"issue_id":"para_plugin-93v","author":"zain","text":"DONE. Files modified: src/utils.ts (added isNestedPath and arePathsNested functions), src/settings.ts (added nested path validation in all 4 folder onChange handlers), src/main.ts (added nested path validation in loadSettings), tests/utils.test.ts (added 15 new test cases for isNestedPath and arePathsNested). All tests pass (43 passed), build succeeds, linting clean, typecheck clean.","created_at":"2026-01-06T21:22:32Z"}]}
{"id":"para_plugin-9fx","title":"Fill in empty author fields in package.json and manifest.json","description":"## Problem\nBoth package.json and manifest.json have empty author fields, which should be filled before community plugin submission.\n\n## Current\npackage.json:24 - \"author\": \"\"\nmanifest.json:7-8 - \"author\": \"\", \"authorUrl\": \"\"\n\n## Fix\nUpdate both files with author information. Use a placeholder or generic value if personal info shouldn't be committed:\n\npackage.json:\n```json\n\"author\": \"Zain Ali\"\n```\n\nmanifest.json:\n```json\n\"author\": \"Zain Ali\",\n\"authorUrl\": \"\"\n```\n\nNote: authorUrl can remain empty if no public URL is desired.\n\n## Files\n- package.json\n- manifest.json","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T13:48:20.845678-06:00","created_by":"zain","updated_at":"2026-01-06T13:49:33.300885-06:00","closed_at":"2026-01-06T13:49:33.300885-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-9ia","title":"Document undocumented internal API usage in focusProjectsFolder","description":"## Problem\nIn `src/main.ts:154-161`, the `focusProjectsFolder()` method uses an undocumented internal Obsidian API:\n\n```typescript\nconst fileExplorerView = fileExplorer.view as {\n  revealInFolder?: (file: TFolder) =\u003e void;\n};\n\nif (typeof fileExplorerView.revealInFolder === 'function') {\n  fileExplorerView.revealInFolder(projectsFolder as TFolder);\n}\n```\n\n`revealInFolder` is not part of Obsidian's public API and could break in future Obsidian updates.\n\n## Current Mitigation\n- Method is wrapped in try/catch\n- Comment marks it as 'best-effort'\n- Uses optional chaining to check if method exists\n\n## Suggested Improvements\n1. Add a comment noting which Obsidian version this was tested on\n2. Consider adding to CLAUDE.md as a known fragile area\n3. Monitor Obsidian changelogs for public API alternatives\n4. Could add Obsidian version check if API location changes\n\n## Files\n- src/main.ts:138-161","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-06T13:12:25.235609-06:00","created_by":"zain","updated_at":"2026-01-06T13:16:16.893487-06:00","closed_at":"2026-01-06T13:16:16.893487-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-9kj","title":"Validate settings on load to catch manual data.json edits","description":"## Problem\nSettings validation (projectsPath !== archivePath) only runs in UI onChange handlers (`src/settings.ts:38-42, 56-60`).\n\nIf someone manually edits `.obsidian/plugins/archive-project/data.json` to set both paths the same, invalid settings load without validation.\n\n## Impact\nLow risk - manual JSON editing is rare. But defense-in-depth is good practice.\n\n## Fix\nAdd validation in `loadSettings()` in `src/main.ts:87-89`:\n\n```typescript\nasync loadSettings(): Promise\u003cvoid\u003e {\n  this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());\n  \n  // Validate loaded settings\n  if (this.settings.projectsPath === this.settings.archivePath) {\n    new Notice('Archive Project: Invalid settings detected (paths match), resetting to defaults');\n    this.settings.projectsPath = DEFAULT_SETTINGS.projectsPath;\n    this.settings.archivePath = DEFAULT_SETTINGS.archivePath;\n    await this.saveSettings();\n  }\n}\n```\n\n## Files\n- src/main.ts:87-89","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-06T13:27:17.216047-06:00","created_by":"zain","updated_at":"2026-01-06T13:35:28.41258-06:00","closed_at":"2026-01-06T13:35:28.41258-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-9xz","title":"Consolidate constants into single location","description":"## Problem\nConstants are defined in multiple files:\n- `MAX_RENAME_RETRIES = 3` in `src/main.ts:14`\n- `MAX_COLLISION_ATTEMPTS = 1000` in `src/utils.ts:7`\n\nThese are related (both deal with collision handling) but scattered.\n\n## Required Fix\nConsolidate into a single constants file or location.\n\n## Options\n1. Create `src/constants.ts` and export both\n2. Move both to `src/utils.ts` since collision logic lives there\n3. Keep in respective files but add cross-reference comments\n\n## Acceptance Criteria\n- [ ] Constants in single location\n- [ ] Both files import from shared location\n- [ ] No duplicate definitions","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-06T15:17:23.286428-06:00","created_by":"zain","updated_at":"2026-01-06T15:44:43.405818-06:00","closed_at":"2026-01-06T15:44:43.405818-06:00","close_reason":"Constants should remain in the files where they're used. MAX_RENAME_RETRIES is only used in main.ts, MAX_COLLISION_ATTEMPTS is only used in utils.ts. Moving them to a shared location adds indirection without benefit."}
{"id":"para_plugin-a01","title":"Rename plugin from Archive Project to PARA Manager","description":"Rename the plugin to reflect the broader North Star vision documented in CLAUDE.md.\n\nThe plugin is evolving from archive-only functionality to full PARA workflow management (creation + archiving). All naming/branding should reflect this broader scope.\n\n## Target Names\n- Plugin ID: `para-manager`\n- Display Name: `PARA Manager`\n\n## Validation\nAfter all subtasks complete:\n1. `yarn build` succeeds\n2. `yarn test` passes\n3. Plugin loads in Obsidian with new name\n4. Settings tab shows \"PARA Manager\"\n5. No references to \"Archive Project\" remain in user-facing text","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-06T15:35:19.251982-06:00","created_by":"zain","updated_at":"2026-01-06T16:15:23.473565-06:00","closed_at":"2026-01-06T16:15:23.473565-06:00","close_reason":"Epic complete. All 5 subtasks closed. Validation passed: yarn build/test succeed, no 'Archive Project' references in user-facing text. Manual validation (plugin load, settings tab) requires Obsidian testing."}
{"id":"para_plugin-a01.1","title":"Update plugin identity in manifest.json and package.json","description":"Update the core plugin identity files to use the new name.\n\n## Changes Required\n\n### manifest.json\n- `id`: `archive-project` → `para-manager`\n- `name`: `Archive Project` → `PARA Manager`\n- `description`: Update to \"Manage PARA folders (Projects, Areas, Resources, Archive) with creation and archiving tools\"\n\n### package.json\n- `name`: `archive-project` → `para-manager`\n- `description`: Update to \"Obsidian plugin for managing PARA folders: create and archive Projects, Areas, Resources\"\n- `keywords`: Add \"creation\", \"areas\", \"resources\" to existing keywords\n\n## Acceptance Criteria\n- Both files updated with new names\n- `yarn build` succeeds after changes","status":"closed","priority":1,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T15:35:39.518912-06:00","created_by":"zain","updated_at":"2026-01-06T16:14:10.295157-06:00","closed_at":"2026-01-06T16:14:10.295157-06:00","close_reason":"All implemented via parallel sub-agents. Verified: yarn typecheck, yarn build, yarn test all pass.","dependencies":[{"issue_id":"para_plugin-a01.1","depends_on_id":"para_plugin-a01","type":"parent-child","created_at":"2026-01-06T15:35:39.519523-06:00","created_by":"zain"}],"comments":[{"id":16,"issue_id":"para_plugin-a01.1","author":"zain","text":"DONE. Files modified: manifest.json, package.json","created_at":"2026-01-06T22:13:19Z"}]}
{"id":"para_plugin-a01.2","title":"Update README.md with new plugin name and description","description":"Update README.md to reflect the broader PARA Manager scope.\n\n## Changes Required\n\n1. **Title** (line 1): `# Archive Project` → `# PARA Manager`\n\n2. **Introduction** (line 3): Rewrite to mention both creation and archiving:\n   \"An Obsidian plugin for managing PARA folders (Projects, Areas, Resources, Archive). Create new items and archive completed ones with ease.\"\n\n3. **Installation paths**: Update all references from:\n   - `.obsidian/plugins/archive-project/` → `.obsidian/plugins/para-manager/`\n\n4. **Settings reference** (line 27): `Open Settings \u003e Archive Project` → `Open Settings \u003e PARA Manager`\n\n5. **Enable plugin instruction** (line 106): `Enable \"Archive Project\" plugin` → `Enable \"PARA Manager\" plugin`\n\n## Acceptance Criteria\n- All \"Archive Project\" references replaced with \"PARA Manager\"\n- All `archive-project` path references replaced with `para-manager`\n- Introduction reflects both creation and archiving capabilities","status":"closed","priority":1,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T15:35:39.968735-06:00","created_by":"zain","updated_at":"2026-01-06T16:14:10.30756-06:00","closed_at":"2026-01-06T16:14:10.30756-06:00","close_reason":"All implemented via parallel sub-agents. Verified: yarn typecheck, yarn build, yarn test all pass.","dependencies":[{"issue_id":"para_plugin-a01.2","depends_on_id":"para_plugin-a01","type":"parent-child","created_at":"2026-01-06T15:35:39.969318-06:00","created_by":"zain"}],"comments":[{"id":18,"issue_id":"para_plugin-a01.2","author":"zain","text":"Updated README.md with new plugin name and description. All required changes completed:\n1. Title updated: 'Archive Project' → 'PARA Manager'\n2. Introduction rewritten to mention both creation and archiving\n3. Installation paths updated: '.obsidian/plugins/archive-project/' → '.obsidian/plugins/para-manager/'\n4. Settings reference updated: 'Open Settings \u003e Archive Project' → 'Open Settings \u003e PARA Manager'\n5. Enable plugin instruction updated: 'Enable \"Archive Project\" plugin' → 'Enable \"PARA Manager\" plugin'","created_at":"2026-01-06T22:13:30Z"},{"id":19,"issue_id":"para_plugin-a01.2","author":"zain","text":"DONE. Files modified: /Users/zain/code/obsidian/para_plugin/README.md","created_at":"2026-01-06T22:13:33Z"}]}
{"id":"para_plugin-a01.3","title":"Rename classes and interfaces in TypeScript code","description":"Rename TypeScript classes and interfaces to use PARA Manager naming.\n\n## Changes Required\n\n### src/main.ts\n- `class ArchiveProjectPlugin` → `class ParaManagerPlugin`\n\n### src/settings.ts\n- `interface ArchiveProjectSettings` → `interface ParaManagerSettings`\n- `class ArchiveProjectSettingTab` → `class ParaManagerSettingTab`\n\n## Files That Import These\nAfter renaming, update imports/references in:\n- `src/main.ts` (uses settings interface and tab)\n- Any test files that reference these types\n\n## Acceptance Criteria\n- All three names updated\n- `yarn typecheck` passes\n- `yarn build` succeeds\n- `yarn test` passes","status":"closed","priority":2,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T15:35:41.681748-06:00","created_by":"zain","updated_at":"2026-01-06T16:14:10.319832-06:00","closed_at":"2026-01-06T16:14:10.319832-06:00","close_reason":"All implemented via parallel sub-agents. Verified: yarn typecheck, yarn build, yarn test all pass.","dependencies":[{"issue_id":"para_plugin-a01.3","depends_on_id":"para_plugin-a01","type":"parent-child","created_at":"2026-01-06T15:35:41.682317-06:00","created_by":"zain"}],"comments":[{"id":14,"issue_id":"para_plugin-a01.3","author":"zain","text":"Starting renaming task. Will rename: 1) ArchiveProjectPlugin -\u003e ParaManagerPlugin, 2) ArchiveProjectSettings -\u003e ParaManagerSettings, 3) ArchiveProjectSettingTab -\u003e ParaManagerSettingTab","created_at":"2026-01-06T22:13:13Z"},{"id":20,"issue_id":"para_plugin-a01.3","author":"zain","text":"DONE. Files modified: src/main.ts, src/settings.ts. All renames completed successfully: ArchiveProjectPlugin -\u003e ParaManagerPlugin, ArchiveProjectSettings -\u003e ParaManagerSettings, ArchiveProjectSettingTab -\u003e ParaManagerSettingTab. yarn typecheck and yarn build both pass. yarn test passes all 43 tests.","created_at":"2026-01-06T22:13:43Z"}]}
{"id":"para_plugin-a01.4","title":"Update code comments referencing old plugin name","description":"Update code comments that reference the old plugin name.\n\n## Changes Required\n\n### src/utils.ts (line 2)\nModule docstring:\n- \"Pure utility functions for the Archive Project plugin\" → \"Pure utility functions for the PARA Manager plugin\"\n\n## Acceptance Criteria\n- No code comments reference \"Archive Project\"\n- Can verify with: `grep -r \"Archive Project\" src/`","status":"closed","priority":3,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T15:35:43.481999-06:00","created_by":"zain","updated_at":"2026-01-06T16:14:10.332209-06:00","closed_at":"2026-01-06T16:14:10.332209-06:00","close_reason":"All implemented via parallel sub-agents. Verified: yarn typecheck, yarn build, yarn test all pass.","dependencies":[{"issue_id":"para_plugin-a01.4","depends_on_id":"para_plugin-a01","type":"parent-child","created_at":"2026-01-06T15:35:43.482545-06:00","created_by":"zain"}],"comments":[{"id":15,"issue_id":"para_plugin-a01.4","author":"zain","text":"Updated module docstring in src/utils.ts from 'Archive Project plugin' to 'PARA Manager plugin' on line 2","created_at":"2026-01-06T22:13:19Z"},{"id":17,"issue_id":"para_plugin-a01.4","author":"zain","text":"DONE. Files modified: /Users/zain/code/obsidian/para_plugin/src/utils.ts","created_at":"2026-01-06T22:13:23Z"}]}
{"id":"para_plugin-a01.5","title":"Update user-facing strings from Archive Project to PARA Manager","description":"Additional user-facing strings in src/main.ts still reference 'Archive Project'.\n\n## Changes Required\n\n### src/main.ts\nLine numbers may have shifted after previous edits, but these strings need updating:\n\n1. Modal title: `\"Archive Project?\"` → `\"Archive Item?\"` or similar\n2. Notice for invalid archive/source match: `\"Archive Project: Invalid settings...\"` → `\"PARA Manager: Invalid settings...\"`\n3. Notice for matching source folders: `\"Archive Project: Invalid settings...\"` → `\"PARA Manager: Invalid settings...\"`\n4. Notice for nested path errors: `\"Archive Project: Invalid settings...\"` → `\"PARA Manager: Invalid settings...\"`\n5. Console error: `\"Archive Project: Failed to archive\"` → `\"PARA Manager: Failed to archive\"`\n6. Console debug: `\"Archive Project: Could not focus\"` → `\"PARA Manager: Could not focus\"`\n\n## Acceptance Criteria\n- `grep -r \"Archive Project\" src/` returns no results\n- yarn build succeeds\n\n**Files likely modified**: src/main.ts","status":"closed","priority":2,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T16:14:24.462891-06:00","created_by":"zain","updated_at":"2026-01-06T16:15:04.185775-06:00","closed_at":"2026-01-06T16:15:04.185775-06:00","close_reason":"Updated all 6 user-facing strings from 'Archive Project' to 'PARA Manager' or 'Archive Item' in src/main.ts. Verified: no 'Archive Project' references remain in src/, yarn typecheck/build/test all pass.","dependencies":[{"issue_id":"para_plugin-a01.5","depends_on_id":"para_plugin-a01","type":"parent-child","created_at":"2026-01-06T16:14:24.46345-06:00","created_by":"zain"}]}
{"id":"para_plugin-alu","title":"Update README test checklist to reflect file archiving support","description":"## Problem\nThe README manual test checklist at line 134-135 is outdated:\n\n```markdown\n- [ ] Right-click a file in Projects/ → \"Archive it\" does NOT appear\n```\n\nBut the plugin now supports archiving both files and folders (intentional behavior confirmed).\n\n## Fix\nUpdate line 135 from:\n```markdown\n- [ ] Right-click a file → \"Archive it\" does NOT appear\n```\n\nTo:\n```markdown\n- [ ] Right-click a file in Projects/ root → \"Archive it\" appears (files can be archived too)\n```\n\nThis matches the existing note at line 135 which already says '(files can be archived too)'.\n\nActually, looking at the current README, line 135 already says:\n```markdown\n- [ ] Right-click a file in Projects/ → \"Archive it\" appears (files can be archived too)\n```\n\nSo the README may already be correct. Verify and close if no change needed.\n\n## Files\n- README.md:134-135","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T14:16:52.834282-06:00","created_by":"zain","updated_at":"2026-01-06T14:19:19.126723-06:00","closed_at":"2026-01-06T14:19:19.126723-06:00","close_reason":"README already correct, no change needed"}
{"id":"para_plugin-asg","title":"Fix inconsistent variable naming for files vs folders","description":"## Problem\nThe `ArchiveConfirmModal` class uses `folderName` for the item being archived, but items can be files OR folders. This should be `itemName` for consistency with the rest of the codebase.\n\n## Current State (Verified)\nThe `archiveItem()` method correctly uses `itemName`. Only the modal class needs updating.\n\n## Changes Required\n\n### src/main.ts - ArchiveConfirmModal class (lines 16-55)\n- Line 18: `private folderName: string;` → `private itemName: string;`\n- Line 27: `folderName: string,` → `itemName: string,`\n- Line 33: `this.folderName = folderName;` → `this.itemName = itemName;`\n- Line 42: `this.folderName` → `this.itemName`\n\n### src/main.ts - Modal instantiation (line ~284)\nThe call site already passes `itemName`, so parameter name change is internal only.\n\n## Files Modified\n- src/main.ts (ArchiveConfirmModal class only)\n\n## Acceptance Criteria\n- [ ] `folderName` renamed to `itemName` in ArchiveConfirmModal\n- [ ] No other \"folder\" variables refer to items that could be files\n- [ ] Build and tests pass","status":"closed","priority":3,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T15:17:24.426716-06:00","created_by":"zain","updated_at":"2026-01-06T16:26:34.75035-06:00","closed_at":"2026-01-06T16:26:34.75035-06:00","close_reason":"Renamed folderName to itemName in ArchiveConfirmModal for consistency (items can be files or folders)."}
{"id":"para_plugin-azg","title":"Refactor normalizer to use dependency injection","description":"## Problem\nCodebase has two path normalizers:\n1. `normalizePathPure()` in `src/utils.ts` - pure function for testing\n2. Obsidian's `normalizePath()` - used in production code\n\nThe comment in utils.ts acknowledges the risk:\n\u003e \"If these diverge (e.g., unicode handling, special chars), path comparisons may fail.\"\n\n## Decision Needed: Is This Worth Doing?\n\n**Cost:** High refactoring effort\n- Every utility function using normalization needs signature changes\n- All call sites in main.ts need to pass Obsidian's normalizer\n- All tests need explicit normalizer parameter\n- Functions affected: `isNestedPath()`, `arePathsNested()`, `isTopLevelProjectFolder()`, `generateArchiveDestination()`, `getParentPath()`\n\n**Benefit:** Theoretical - prevents silent failures if Obsidian changes normalization\n\n**Recommendation:** Close as \"won't fix\" unless:\n1. There's evidence of actual divergence causing bugs\n2. The plugin is being published and needs defensive coding\n\nIf proceeding anyway, here's the implementation approach:\n\n## Implementation (If Approved)\n\n### 1. Create normalizer type in utils.ts\n```typescript\nexport type PathNormalizer = (path: string) =\u003e string;\n```\n\n### 2. Update utility function signatures\nAdd `normalize: PathNormalizer` as first parameter to:\n- `isNestedPath(normalize, path1, path2)`\n- `arePathsNested(normalize, paths)`\n- `isTopLevelProjectFolder(normalize, itemPath, sourcePath)`\n- `generateArchiveDestination(normalize, archivePath, itemName, existingPaths)`\n- `getParentPath(normalize, path)`\n\n### 3. Update main.ts call sites\nPass `normalizePath` from Obsidian import to all utility calls.\n\n### 4. Update tests\nPass `normalizePathPure` to all utility calls in tests.\n\n## Acceptance Criteria\n- [ ] All utility functions accept normalizer as parameter\n- [ ] main.ts passes Obsidian's `normalizePath`\n- [ ] Tests pass `normalizePathPure`\n- [ ] Comment explains the DI pattern\n- [ ] All tests pass, build succeeds","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:17:17.583031-06:00","created_by":"zain","updated_at":"2026-01-06T16:26:41.902256-06:00","closed_at":"2026-01-06T16:26:41.902256-06:00","close_reason":"Won't fix: High refactoring cost for theoretical benefit. No evidence of actual normalization divergence causing bugs. If issues arise, can revisit."}
{"id":"para_plugin-b7d","title":"Update README with new settings and fix documentation inconsistencies","description":"## Problems\n1. README doesn't document the new 'confirmBeforeArchive' setting (added recently)\n2. Line 128 says files won't show Archive option, but code now allows archiving files\n3. README doesn't mention OBSIDIAN_TEST_VAULT env var for install script\n\n## Fixes Required\n\n1. Update settings table (around line 29-33) to add confirmBeforeArchive:\n```markdown\n| Setting | Default | Description |\n|---------|---------|-------------|\n| Projects folder | `Projects` | Path to your top-level projects folder |\n| Archive folder | `Archive` | Where archived projects are moved |\n| Focus after archive | `true` | Return focus to Projects folder after archiving |\n| Confirm before archive | `false` | Show confirmation dialog before archiving |\n```\n\n2. Update line 128 to reflect that files CAN be archived:\nChange: `- [ ] Right-click a file → \"Archive it\" does NOT appear`\nTo: `- [ ] Right-click a file in Projects/ → \"Archive it\" appears (files can be archived too)`\n\n3. Add env var documentation in the Development section (around line 92-95):\n```markdown\nOr set the OBSIDIAN_TEST_VAULT environment variable:\n\\`\\`\\`bash\nexport OBSIDIAN_TEST_VAULT=\"/path/to/your/vault\"\nnpm run install:dev\n\\`\\`\\`\n```\n\n## Files\n- README.md","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T13:50:09.245017-06:00","created_by":"zain","updated_at":"2026-01-06T13:51:18.010854-06:00","closed_at":"2026-01-06T13:51:18.010854-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-c7x","title":"Document normalizer coupling between utils.ts and Obsidian API","description":"## Problem\nIn `src/main.ts:32`, `isTopLevelProjectFolder()` is called with:\n- `file.path` - raw path from Obsidian\n- `projectsPath` - already normalized via Obsidian's `normalizePath()`\n\nBut `isTopLevelProjectFolder()` in `src/utils.ts:35-45` applies its own `normalizePathPure()` to both arguments.\n\n## Risk\nIf Obsidian's `normalizePath` and our `normalizePathPure` behave differently in edge cases (e.g., unicode normalization, special characters), the comparison could fail unexpectedly.\n\n## Current State\nBoth implementations currently align in behavior for common cases:\n- Trim leading/trailing slashes\n- Collapse multiple slashes\n- Convert backslashes to forward slashes\n\n## Suggested Improvements\n1. Add a comment in utils.ts documenting this assumption\n2. Add test cases that verify `normalizePathPure` matches Obsidian's behavior for edge cases\n3. Consider having `isTopLevelProjectFolder` accept a flag indicating paths are pre-normalized\n\n## Files\n- src/main.ts:31-32\n- src/utils.ts:35-45","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-06T13:12:52.544469-06:00","created_by":"zain","updated_at":"2026-01-06T13:18:12.434517-06:00","closed_at":"2026-01-06T13:18:12.434517-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-cv7","title":"Rename getFolderName to getItemName for clarity","description":"## Problem\nIn `src/utils.ts:60`, the function is named `getFolderName` but it's used for both files and folders:\n\n```typescript\nexport function getFolderName(folderPath: string): string {\n```\n\nIn `src/main.ts:141`:\n```typescript\nconst itemName = getFolderName(item.path); // item can be TFile or TFolder\n```\n\n## Suggested Fix\nRename to `getItemName` or `getBaseName` to accurately reflect its purpose:\n\n1. In `src/utils.ts`:\n   - Rename function to `getItemName`\n   - Update JSDoc: 'Get the item name (file or folder) from a path'\n\n2. In `src/main.ts`:\n   - Update import\n   - Usage already correct (`itemName`)\n\n3. In `tests/utils.test.ts`:\n   - Rename test describe block\n   - Update import\n\n## Files\n- src/utils.ts:57-67\n- src/main.ts:9,141\n- tests/utils.test.ts:113-130\n\n## Note\nThis is a low-priority cosmetic change. The function works correctly regardless of name.","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T14:17:04.419994-06:00","created_by":"zain","updated_at":"2026-01-06T14:21:08.626043-06:00","closed_at":"2026-01-06T14:21:08.626043-06:00","close_reason":"Renamed to getItemName"}
{"id":"para_plugin-e2z","title":"Add validation/warning for non-existent source folders","description":"## Problem\nPlugin accepts settings for non-existent folders without any feedback. When user configures `projectsPath = \"MyProjects\"` but that folder doesn't exist:\n- No warning shown\n- Context menu never appears (nothing matches)\n- User has no idea why plugin \"doesn't work\"\n\n## Recommended Scope (Simplified)\n\nFocus on Notice warnings only. Visual indicators in settings UI require fragile DOM manipulation that may break with Obsidian updates.\n\n### ✅ Implement: Warning on plugin load\n- Check if configured source folders exist\n- Show a Notice if any are missing: \"PARA Manager: Projects folder 'X' does not exist. Check plugin settings.\"\n- Non-blocking (plugin still loads)\n\n### ✅ Implement: Warning on settings save  \n- When user changes a folder path in settings, validate it exists\n- Show Notice if folder doesn't exist: \"Warning: Folder 'X' does not exist\"\n- Still allow saving (user may create folder later)\n\n### ❌ Skip: Visual indicator in settings UI\nObsidian's `Setting` API doesn't expose styling hooks for input fields. Achieving this would require:\n- Accessing internal DOM elements via `settingEl.querySelector()`\n- Adding/removing CSS classes manually\n- Risk of breaking when Obsidian updates its internal structure\n\nNot worth the maintenance burden for a P4 feature.\n\n## Implementation\n\n### src/main.ts - loadSettings()\nAfter loading settings, check each source folder:\n```typescript\nconst missingFolders: string[] = [];\nfor (const folder of this.getSourceFolders()) {\n  if (!this.app.vault.getAbstractFileByPath(folder)) {\n    missingFolders.push(folder);\n  }\n}\nif (missingFolders.length \u003e 0) {\n  new Notice(`PARA Manager: Folders not found: ${missingFolders.join(', ')}. Check plugin settings.`);\n}\n```\n\n### src/settings.ts - onChange handlers\nAfter validating path format, add existence check:\n```typescript\nconst folder = this.plugin.app.vault.getAbstractFileByPath(normalized);\nif (!folder) {\n  new Notice(`Warning: Folder '${normalized}' does not exist`);\n}\n// Still save - user may create folder later\n```\n\n## Files Modified\n- src/main.ts (loadSettings)\n- src/settings.ts (onChange handlers for all 4 folder inputs)\n\n## Acceptance Criteria\n- [ ] Warning Notice shown on plugin load if any source folder doesn't exist\n- [ ] Warning Notice shown when saving settings with non-existent folder\n- [ ] All warnings are non-blocking (plugin still functions)\n- [ ] Clear messages explaining the issue","status":"open","priority":4,"issue_type":"feature","created_at":"2026-01-06T15:17:24.770847-06:00","created_by":"zain","updated_at":"2026-01-06T16:00:52.784765-06:00"}
{"id":"para_plugin-e6z","title":"Add Creation Commands for PARA items","description":"## Overview\nAdd command palette commands to create new Projects, Areas, and Resources. This is the second pillar of the North Star vision (Creation), complementing the existing Archive functionality.\n\n## Scope\nThree new commands:\n- **Create Project** — Creates a new project folder with optional date prefix\n- **Create Area** — Creates a new area folder  \n- **Create Resource** — Creates a new resource folder\n\nEach command will:\n1. Show a modal prompting for a name\n2. Create the folder in the correct PARA location\n3. Create an index note inside the folder (e.g., `index.md` or `{name}.md`)\n4. (Future) Apply user-customizable template\n\n## Phased Implementation\n**Phase 1**: Basic creation (folder + index note, no templates)\n**Phase 2**: Add settings for customization (date prefixes, index note naming)\n**Phase 3**: Template support (Templater integration)\n\n## Validation\nAfter subtasks complete:\n1. All three commands appear in command palette\n2. Each creates folder in correct location\n3. Each creates index note inside folder\n4. `yarn test` passes\n5. `yarn build` succeeds","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-06T16:08:33.886545-06:00","created_by":"zain","updated_at":"2026-01-06T16:08:33.886545-06:00"}
{"id":"para_plugin-e6z.1","title":"Add 'Create Project' command","description":"## Feature\nAdd a command palette command to create a new project folder.\n\n## Behavior\n1. User triggers 'Create Project' from command palette\n2. Modal appears prompting for project name\n3. On confirm: creates folder at `{projectsPath}/{name}/`\n4. Creates index note at `{projectsPath}/{name}/index.md` with title `# {name}`\n5. Opens the index note in the editor\n6. Shows success Notice\n\n## Implementation\n\n### 1. Create NameInputModal class (reusable for all creation commands)\n```typescript\nclass NameInputModal extends Modal {\n  private onSubmit: (name: string) =\u003e void;\n  private placeholder: string;\n  private title: string;\n\n  constructor(app: App, title: string, placeholder: string, onSubmit: (name: string) =\u003e void) {\n    super(app);\n    this.title = title;\n    this.placeholder = placeholder;\n    this.onSubmit = onSubmit;\n  }\n\n  onOpen() {\n    const { contentEl } = this;\n    contentEl.createEl('h2', { text: this.title });\n    \n    const input = contentEl.createEl('input', { type: 'text', placeholder: this.placeholder });\n    input.style.width = '100%';\n    input.focus();\n    \n    input.addEventListener('keydown', (e) =\u003e {\n      if (e.key === 'Enter' \u0026\u0026 input.value.trim()) {\n        this.onSubmit(input.value.trim());\n        this.close();\n      }\n      if (e.key === 'Escape') {\n        this.close();\n      }\n    });\n    \n    const buttonContainer = contentEl.createDiv({ cls: 'modal-button-container' });\n    const submitBtn = buttonContainer.createEl('button', { text: 'Create', cls: 'mod-cta' });\n    submitBtn.addEventListener('click', () =\u003e {\n      if (input.value.trim()) {\n        this.onSubmit(input.value.trim());\n        this.close();\n      }\n    });\n  }\n}\n```\n\n### 2. Register command in onload()\n```typescript\nthis.addCommand({\n  id: 'create-project',\n  name: 'Create Project',\n  callback: () =\u003e {\n    new NameInputModal(\n      this.app,\n      'Create Project',\n      'Project name',\n      (name) =\u003e this.createProject(name)\n    ).open();\n  },\n});\n```\n\n### 3. Add createProject() method\n```typescript\nasync createProject(name: string): Promise\u003cvoid\u003e {\n  const projectPath = normalizePath(`${this.settings.projectsPath}/${name}`);\n  \n  // Check if folder already exists\n  if (this.app.vault.getAbstractFileByPath(projectPath)) {\n    new Notice(`Project '${name}' already exists`);\n    return;\n  }\n  \n  // Create folder\n  await this.app.vault.createFolder(projectPath);\n  \n  // Create index note\n  const indexPath = normalizePath(`${projectPath}/index.md`);\n  const indexContent = `# ${name}\\n`;\n  const file = await this.app.vault.create(indexPath, indexContent);\n  \n  // Open the note\n  await this.app.workspace.getLeaf().openFile(file);\n  \n  new Notice(`Created project '${name}'`);\n}\n```\n\n## Files Modified\n- src/main.ts (NameInputModal class, createProject method, command registration)\n\n## Acceptance Criteria\n- [ ] Command appears in palette as 'Create Project'\n- [ ] Modal prompts for name with Enter to submit\n- [ ] Folder created at correct path\n- [ ] index.md created with project name as title\n- [ ] Index note opens after creation\n- [ ] Error shown if project already exists\n- [ ] Build and tests pass","status":"closed","priority":2,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T16:08:51.925638-06:00","created_by":"zain","updated_at":"2026-01-06T16:42:17.39525-06:00","closed_at":"2026-01-06T16:42:17.39525-06:00","close_reason":"Implemented all three creation commands with shared createParaItem() method. NameInputModal added to modals.ts. Commands: create-project, create-area, create-resource.","dependencies":[{"issue_id":"para_plugin-e6z.1","depends_on_id":"para_plugin-e6z","type":"parent-child","created_at":"2026-01-06T16:08:51.926189-06:00","created_by":"zain"}]}
{"id":"para_plugin-e6z.2","title":"Add 'Create Area' command","description":"## Feature\nAdd a command palette command to create a new area folder.\n\n## Behavior\nSame as Create Project but uses `areasPath` setting.\n\n1. User triggers 'Create Area' from command palette\n2. Modal appears prompting for area name (reuse NameInputModal)\n3. On confirm: creates folder at `{areasPath}/{name}/`\n4. Creates index note at `{areasPath}/{name}/index.md` with title `# {name}`\n5. Opens the index note in the editor\n6. Shows success Notice\n\n## Implementation\n\n### 1. Register command in onload()\n```typescript\nthis.addCommand({\n  id: 'create-area',\n  name: 'Create Area',\n  callback: () =\u003e {\n    new NameInputModal(\n      this.app,\n      'Create Area',\n      'Area name',\n      (name) =\u003e this.createArea(name)\n    ).open();\n  },\n});\n```\n\n### 2. Add createArea() method\n```typescript\nasync createArea(name: string): Promise\u003cvoid\u003e {\n  const areaPath = normalizePath(`${this.settings.areasPath}/${name}`);\n  \n  if (this.app.vault.getAbstractFileByPath(areaPath)) {\n    new Notice(`Area '${name}' already exists`);\n    return;\n  }\n  \n  await this.app.vault.createFolder(areaPath);\n  \n  const indexPath = normalizePath(`${areaPath}/index.md`);\n  const file = await this.app.vault.create(indexPath, `# ${name}\\n`);\n  \n  await this.app.workspace.getLeaf().openFile(file);\n  new Notice(`Created area '${name}'`);\n}\n```\n\n## Dependencies\n- Requires NameInputModal from para_plugin-e6z.1\n\n## Files Modified\n- src/main.ts (createArea method, command registration)\n\n## Acceptance Criteria\n- [ ] Command appears in palette as 'Create Area'\n- [ ] Folder created at areasPath\n- [ ] index.md created and opened\n- [ ] Error shown if area already exists","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:09:03.308282-06:00","created_by":"zain","updated_at":"2026-01-06T16:42:17.396952-06:00","closed_at":"2026-01-06T16:42:17.396952-06:00","close_reason":"Implemented all three creation commands with shared createParaItem() method. NameInputModal added to modals.ts. Commands: create-project, create-area, create-resource.","dependencies":[{"issue_id":"para_plugin-e6z.2","depends_on_id":"para_plugin-e6z","type":"parent-child","created_at":"2026-01-06T16:09:03.308888-06:00","created_by":"zain"},{"issue_id":"para_plugin-e6z.2","depends_on_id":"para_plugin-e6z.1","type":"blocks","created_at":"2026-01-06T16:09:35.254267-06:00","created_by":"zain"}]}
{"id":"para_plugin-e6z.3","title":"Add 'Create Resource' command","description":"## Feature\nAdd a command palette command to create a new resource folder.\n\n## Behavior\nSame as Create Project/Area but uses `resourcesPath` setting.\n\n1. User triggers 'Create Resource' from command palette\n2. Modal appears prompting for resource name (reuse NameInputModal)\n3. On confirm: creates folder at `{resourcesPath}/{name}/`\n4. Creates index note at `{resourcesPath}/{name}/index.md` with title `# {name}`\n5. Opens the index note in the editor\n6. Shows success Notice\n\n## Implementation\n\n### 1. Register command in onload()\n```typescript\nthis.addCommand({\n  id: 'create-resource',\n  name: 'Create Resource',\n  callback: () =\u003e {\n    new NameInputModal(\n      this.app,\n      'Create Resource',\n      'Resource name',\n      (name) =\u003e this.createResource(name)\n    ).open();\n  },\n});\n```\n\n### 2. Add createResource() method\n```typescript\nasync createResource(name: string): Promise\u003cvoid\u003e {\n  const resourcePath = normalizePath(`${this.settings.resourcesPath}/${name}`);\n  \n  if (this.app.vault.getAbstractFileByPath(resourcePath)) {\n    new Notice(`Resource '${name}' already exists`);\n    return;\n  }\n  \n  await this.app.vault.createFolder(resourcePath);\n  \n  const indexPath = normalizePath(`${resourcePath}/index.md`);\n  const file = await this.app.vault.create(indexPath, `# ${name}\\n`);\n  \n  await this.app.workspace.getLeaf().openFile(file);\n  new Notice(`Created resource '${name}'`);\n}\n```\n\n## Dependencies\n- Requires NameInputModal from para_plugin-e6z.1\n\n## Files Modified\n- src/main.ts (createResource method, command registration)\n\n## Acceptance Criteria\n- [ ] Command appears in palette as 'Create Resource'\n- [ ] Folder created at resourcesPath\n- [ ] index.md created and opened\n- [ ] Error shown if resource already exists","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:09:12.932286-06:00","created_by":"zain","updated_at":"2026-01-06T16:42:17.398557-06:00","closed_at":"2026-01-06T16:42:17.398557-06:00","close_reason":"Implemented all three creation commands with shared createParaItem() method. NameInputModal added to modals.ts. Commands: create-project, create-area, create-resource.","dependencies":[{"issue_id":"para_plugin-e6z.3","depends_on_id":"para_plugin-e6z","type":"parent-child","created_at":"2026-01-06T16:09:12.932848-06:00","created_by":"zain"},{"issue_id":"para_plugin-e6z.3","depends_on_id":"para_plugin-e6z.1","type":"blocks","created_at":"2026-01-06T16:09:35.30344-06:00","created_by":"zain"}]}
{"id":"para_plugin-e6z.4","title":"Add project date prefix option","description":"## Feature\nCustomizable project folder naming with date prefix using Moment.js tokens (same as Obsidian Daily Notes).\n\n## Behavior\nA format string setting controls project folder names:\n- **Moment.js date tokens**: YYYY, MM, DD, ddd, MMM, etc. (same format as Daily Notes plugin)\n- **`{{name}}` placeholder**: replaced with the project name entered by user\n\n### Examples\n| Format String | Input | Result |\n|--------------|-------|--------|\n| `YYYY-MM-DD {{name}}` | Website Redesign | `2024-01-15 Website Redesign` |\n| `{{name}} (YYYY-MM)` | Website Redesign | `Website Redesign (2024-01)` |\n| `YYYYMMDD-{{name}}` | Website Redesign | `20240115-Website Redesign` |\n| `{{name}}` | Website Redesign | `Website Redesign` (no date) |\n\n## Settings to Add\n\n### In ParaManagerSettings interface\n```typescript\nprojectFolderFormat: string;  // Default: 'YYYY-MM-DD {{name}}'\n```\n\n### In Settings UI\nAdd under 'Project Creation' heading:\n- **Project folder format**\n  - Default value: 'YYYY-MM-DD {{name}}'\n  - Help text (shown as description): \n    'Format for new project folder names. Use {{name}} for the project name. Supports Moment.js date tokens: YYYY (year), MM (month), DD (day). Example: YYYY-MM-DD {{name}} creates \"2024-01-15 My Project\"'\n\n## Implementation\n\n### Add formatProjectName() helper\n```typescript\nprivate formatProjectName(name: string, format: string): string {\n  // Obsidian exposes moment globally as window.moment\n  const now = window.moment();\n  \n  // First replace {{name}} placeholder to avoid moment interpreting it\n  let result = format.replace(/\\{\\{name\\}\\}/g, name);\n  \n  // Then format any remaining Moment.js tokens\n  result = now.format(result);\n  \n  return result;\n}\n```\n\nNote: `window.moment` is globally available in Obsidian - no import needed.\n\n## Files Modified\n- src/settings.ts (new setting + UI with help text)\n- src/main.ts (formatProjectName helper, update createParaItem for projects)\n\n## Acceptance Criteria\n- [ ] Project folder format setting appears in settings\n- [ ] Help text clearly explains the format syntax with examples\n- [ ] Default is 'YYYY-MM-DD {{name}}'\n- [ ] Moment.js date tokens work correctly\n- [ ] {{name}} placeholder is replaced with user input\n- [ ] Index note title uses just the name (not the formatted folder name)\n- [ ] Validation: format must contain {{name}} placeholder","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-06T16:09:29.469166-06:00","created_by":"zain","updated_at":"2026-01-06T17:12:12.567707-06:00","dependencies":[{"issue_id":"para_plugin-e6z.4","depends_on_id":"para_plugin-e6z","type":"parent-child","created_at":"2026-01-06T16:09:29.469745-06:00","created_by":"zain"},{"issue_id":"para_plugin-e6z.4","depends_on_id":"para_plugin-e6z.1","type":"blocks","created_at":"2026-01-06T16:09:35.351204-06:00","created_by":"zain"}]}
{"id":"para_plugin-e6z.5","title":"Refactor creation commands to use shared helper","description":"## Problem\nAfter implementing all three creation commands (Project, Area, Resource), there will be code duplication. Each method does:\n1. Build path from settings + name\n2. Check if exists\n3. Create folder\n4. Create index note\n5. Open note\n6. Show notice\n\n## Solution\nExtract shared logic into a `createItem()` helper method.\n\n## Implementation\n\n```typescript\nprivate async createItem(\n  type: 'project' | 'area' | 'resource',\n  basePath: string,\n  name: string\n): Promise\u003cvoid\u003e {\n  const itemPath = normalizePath(`${basePath}/${name}`);\n  \n  if (this.app.vault.getAbstractFileByPath(itemPath)) {\n    new Notice(`${this.capitalize(type)} '${name}' already exists`);\n    return;\n  }\n  \n  await this.ensureFolderExists(itemPath);\n  \n  const indexPath = normalizePath(`${itemPath}/index.md`);\n  const file = await this.app.vault.create(indexPath, `# ${name}\\n`);\n  \n  await this.app.workspace.getLeaf().openFile(file);\n  new Notice(`Created ${type} '${name}'`);\n}\n\nprivate capitalize(s: string): string {\n  return s.charAt(0).toUpperCase() + s.slice(1);\n}\n```\n\nThen simplify each command:\n```typescript\nasync createProject(name: string): Promise\u003cvoid\u003e {\n  // Handle date prefix if enabled\n  let folderName = name;\n  if (this.settings.projectDatePrefix) {\n    folderName = `${this.formatDate(this.settings.projectDateFormat)} ${name}`;\n  }\n  await this.createItem('project', this.settings.projectsPath, folderName);\n}\n\nasync createArea(name: string): Promise\u003cvoid\u003e {\n  await this.createItem('area', this.settings.areasPath, name);\n}\n\nasync createResource(name: string): Promise\u003cvoid\u003e {\n  await this.createItem('resource', this.settings.resourcesPath, name);\n}\n```\n\n## Dependencies\n- Requires all three creation commands to be implemented first\n\n## Files Modified\n- src/main.ts\n\n## Acceptance Criteria\n- [ ] Shared `createItem()` helper extracts common logic\n- [ ] All three commands use the helper\n- [ ] Project date prefix logic stays in createProject\n- [ ] All functionality preserved\n- [ ] Tests pass","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-06T16:09:54.791125-06:00","created_by":"zain","updated_at":"2026-01-06T16:42:23.849976-06:00","closed_at":"2026-01-06T16:42:23.849976-06:00","close_reason":"Already implemented: createParaItem() is a shared helper used by all three creation commands from the start.","dependencies":[{"issue_id":"para_plugin-e6z.5","depends_on_id":"para_plugin-e6z","type":"parent-child","created_at":"2026-01-06T16:09:54.791732-06:00","created_by":"zain"},{"issue_id":"para_plugin-e6z.5","depends_on_id":"para_plugin-e6z.2","type":"blocks","created_at":"2026-01-06T16:09:59.000503-06:00","created_by":"zain"},{"issue_id":"para_plugin-e6z.5","depends_on_id":"para_plugin-e6z.3","type":"blocks","created_at":"2026-01-06T16:09:59.049247-06:00","created_by":"zain"}]}
{"id":"para_plugin-ev9","title":"Settings validation blocks typing on partial path overlap","description":"## Problem\nSettings folder validation runs on every keystroke (onChange), which blocks typing when a partial match occurs.\n\n**Reproduction:**\n1. Set Projects folder to \"foo\"\n2. Try to set Areas folder to \"food\"\n3. When typing the second 'o' in \"food\", validation fires because \"foo\" is a prefix of \"foo\" (partial match during typing)\n4. Error notice appears and the character is rejected\n\n## Expected Behavior\n- Validation should run on blur (when focus leaves the text box), not on every keystroke\n- Invalid state should be shown with a red text box border, not by blocking input\n- User should be able to type freely, then see validation result when they tab/click away\n\n## Current Behavior\n- Validation runs on onChange (every keystroke)\n- Invalid input triggers Notice and reverts the value immediately\n- This prevents typing valid paths that temporarily look like partial overlaps\n\n## Solution\n1. Change onChange to store the pending value without validation\n2. Add onBlur handler that:\n   - Validates the pending value\n   - If invalid: show red border + error message (not Notice), keep focus\n   - If valid: save the setting\n3. Consider debounced validation for real-time feedback without blocking\n\n## Files to Modify\n- src/settings.ts (ParaManagerSettingTab.display method)\n\n## Acceptance Criteria\n- [ ] Can type \"food\" when \"foo\" exists without being blocked\n- [ ] Validation occurs on blur/focus-out\n- [ ] Invalid paths show visual indicator (red border)\n- [ ] Valid paths save on blur\n- [ ] Error messages are clear about what's wrong","status":"closed","priority":2,"issue_type":"bug","assignee":"zain","created_at":"2026-01-06T16:38:40.69307-06:00","created_by":"zain","updated_at":"2026-01-06T16:39:50.759791-06:00","closed_at":"2026-01-06T16:39:50.759791-06:00","close_reason":"Changed settings validation from onChange to onBlur. Users can now type freely; validation occurs when leaving the field. Invalid paths show red border and revert to last valid value."}
{"id":"para_plugin-gjo","title":"Add test for MAX_COLLISION_ATTEMPTS error branch","description":"## Problem\nIn `src/utils.ts:110-112`, the error branch when too many collisions occur is untested:\n\n```typescript\nif (counter \u003e MAX_COLLISION_ATTEMPTS) {\n  throw new Error('Too many archive collisions - please clean up your archive folder');\n}\n```\n\n## Fix\nAdd test in `tests/utils.test.ts` that creates a Set which always returns `has() === true`:\n\n```typescript\nit('throws error when MAX_COLLISION_ATTEMPTS exceeded', () =\u003e {\n  // Create a Set-like object that always reports collision\n  const alwaysCollides = {\n    has: () =\u003e true,\n  } as Set\u003cstring\u003e;\n  \n  expect(() =\u003e \n    generateArchiveDestination('Archive', 'Project', alwaysCollides)\n  ).toThrow('Too many archive collisions');\n});\n```\n\nOr use a real Set with 1001+ entries (slower but more realistic).\n\n## Files\n- tests/utils.test.ts (add new test in generateArchiveDestination describe block)","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-06T13:27:30.306933-06:00","created_by":"zain","updated_at":"2026-01-06T13:33:18.08227-06:00","closed_at":"2026-01-06T13:33:18.08227-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-grk","title":"Update CLAUDE.md project structure diagram","description":"## Problem\nThe project structure diagram in CLAUDE.md doesn't show newer files like AGENTS.md or the .beads/ directory.\n\n## Current Structure (CLAUDE.md lines 17-33)\nMissing:\n- AGENTS.md\n- .beads/ directory\n\n## Fix\nUpdate the structure diagram to reflect current state:\n```\narchive-project/\n├── src/\n│   ├── main.ts           # Plugin entry point\n│   ├── settings.ts       # Settings tab and interface\n│   └── utils.ts          # Pure utility functions (testable)\n├── scripts/\n│   └── install-dev.mjs   # Dev installation script\n├── tests/\n│   └── utils.test.ts     # Unit tests for pure functions\n├── .beads/               # BD task tracking database\n├── manifest.json         # Obsidian plugin manifest\n├── versions.json         # Version compatibility mapping\n├── package.json\n├── tsconfig.json\n├── eslint.config.mjs\n├── esbuild.config.mjs\n├── CLAUDE.md\n├── AGENTS.md\n└── README.md\n```\n\n## Files\n- CLAUDE.md","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T13:48:18.791732-06:00","created_by":"zain","updated_at":"2026-01-06T13:49:33.291248-06:00","closed_at":"2026-01-06T13:49:33.291248-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-gux","title":"Add explicit Escape key handling in confirmation modal","description":"## Problem\nThe modal handles Enter key explicitly but relies on Obsidian's default Escape handling. Adding explicit handling improves robustness.\n\n## Current Code (src/main.ts:59-66)\n```typescript\nconst handleKeydown = (e: KeyboardEvent) =\u003e {\n  if (e.key === 'Enter' \u0026\u0026 !e.isComposing) {\n    e.preventDefault();\n    this.confirmed = true;\n    this.onConfirm();\n    this.close();\n  }\n};\n```\n\n## Fix\nAdd Escape key handling to the same handler:\n```typescript\nconst handleKeydown = (e: KeyboardEvent) =\u003e {\n  if (e.key === 'Enter' \u0026\u0026 !e.isComposing) {\n    e.preventDefault();\n    this.confirmed = true;\n    this.onConfirm();\n    this.close();\n  } else if (e.key === 'Escape') {\n    e.preventDefault();\n    this.close();\n  }\n};\n```\n\n## Files\n- src/main.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T13:50:12.06252-06:00","created_by":"zain","updated_at":"2026-01-06T13:51:18.022559-06:00","closed_at":"2026-01-06T13:51:18.022559-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-huu","title":"Add afterEach to restore timers in vitest tests","description":"## Problem\nIn `tests/utils.test.ts:133-137`, the `generateArchiveDestination` test suite uses fake timers but never restores them:\n\n```typescript\ndescribe('generateArchiveDestination', () =\u003e {\n  beforeEach(() =\u003e {\n    vi.useFakeTimers();\n    vi.setSystemTime(new Date('2024-03-15T12:00:00Z'));\n  });\n  // Missing: afterEach(() =\u003e vi.useRealTimers());\n```\n\n## Impact\nFake timers leak into subsequent test files if test order changes or new test files are added. This can cause flaky tests that are hard to debug.\n\n## Fix\nAdd afterEach cleanup:\n\n```typescript\nafterEach(() =\u003e {\n  vi.useRealTimers();\n});\n```\n\nOr use `vi.restoreAllMocks()` if other mocks are added later.\n\n## Files\n- tests/utils.test.ts:133-137","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T13:11:55.277708-06:00","created_by":"zain","updated_at":"2026-01-06T13:15:31.330377-06:00","closed_at":"2026-01-06T13:15:31.330377-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-ijh","title":"Fix ensureFolderExists for nested archive paths","description":"## Problem\n`ensureFolderExists()` in `src/main.ts:283-289` doesn't handle nested archive paths.\n\nIf user sets `archivePath = \"Deep/Nested/Archive\"` and neither `Deep` nor `Deep/Nested` exist, `vault.createFolder()` throws because Obsidian doesn't create parent directories.\n\n## Current Code\n```typescript\nprivate async ensureFolderExists(folderPath: string): Promise\u003cvoid\u003e {\n  const folder = this.app.vault.getAbstractFileByPath(folderPath);\n  if (!folder) {\n    await this.app.vault.createFolder(folderPath);  // Fails if parents don't exist\n  }\n}\n```\n\n## Required Fix\nRecursively create parent folders before creating the target folder.\n\n## Acceptance Criteria\n- [ ] Modify `ensureFolderExists()` to create parent directories\n- [ ] Handle edge case where intermediate path exists as a file (throw clear error)\n- [ ] Test with deeply nested archive path configuration","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T15:17:16.928667-06:00","created_by":"zain","updated_at":"2026-01-06T15:26:58.93494-06:00","closed_at":"2026-01-06T15:26:58.93494-06:00","close_reason":"Implemented via parallel sub-agents. All 43 tests pass, typecheck/lint/build all succeed.","comments":[{"id":8,"issue_id":"para_plugin-ijh","author":"zain","text":"Starting implementation. Current ensureFolderExists at lines 311-318 in src/main.ts does not create parent directories. Need to implement recursive parent creation.","created_at":"2026-01-06T21:23:18Z"},{"id":9,"issue_id":"para_plugin-ijh","author":"zain","text":"DONE. Files modified: src/main.ts. Implementation recursively creates parent directories by splitting the path into segments and creating each one from root to target. Handles edge case where intermediate path exists as a file by throwing clear error message. All tests pass, build succeeds, linting passes.","created_at":"2026-01-06T21:23:43Z"}]}
{"id":"para_plugin-ive","title":"Make onClick handler explicitly async","description":"## Problem\nIn `src/main.ts:40`, the onClick handler returns a Promise but isn't marked async:\n\n```typescript\n.onClick(() =\u003e this.archiveFolder(file));\n```\n\nThis returns a Promise that Obsidian ignores. It works, but the intent is unclear.\n\n## Suggested Fix\nEither make it explicitly async (if we want to await):\n```typescript\n.onClick(async () =\u003e {\n  await this.archiveFolder(file);\n});\n```\n\nOr use void to indicate fire-and-forget:\n```typescript\n.onClick(() =\u003e {\n  void this.archiveFolder(file);\n});\n```\n\nThe first option is preferred as it matches the pattern used elsewhere in the codebase.\n\n## Files\n- src/main.ts:40","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T13:13:49.170034-06:00","created_by":"zain","updated_at":"2026-01-06T13:16:46.030274-06:00","closed_at":"2026-01-06T13:16:46.030274-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-ja0","title":"Extract folder operations to src/folder-ops.ts","description":"## Problem\nmain.ts contains folder utility methods that are generic and will be reused by creation commands:\n- ensureFolderExists() - creates folder and parents\n- getExistingArchivePaths() - gets children of a folder (rename to getExistingPaths)\n- focusSourceFolder() - focuses file explorer on folder (rename to focusFolder)\n\n## Solution\nExtract to src/folder-ops.ts as standalone functions that take App as parameter.\n\n## Changes\n1. Create src/folder-ops.ts\n2. Move and adapt the 3 methods:\n   - ensureFolderExists(app, folderPath)\n   - getExistingPaths(app, folderPath) \n   - focusFolder(app, folderPath)\n3. Update main.ts to import and use these functions\n\n**Files likely modified**: src/main.ts, src/folder-ops.ts (new)","status":"closed","priority":2,"issue_type":"task","assignee":"zain","created_at":"2026-01-06T16:28:43.745896-06:00","created_by":"zain","updated_at":"2026-01-06T16:31:03.857188-06:00","closed_at":"2026-01-06T16:31:03.857188-06:00","close_reason":"Extracted ensureFolderExists, getExistingPaths, focusFolder to src/folder-ops.ts. main.ts reduced from 393 to 300 lines. Functions now reusable for creation commands."}
{"id":"para_plugin-l5y","title":"Validate that Archive folder differs from Projects folder","description":"## Problem\nUsers can set both `projectsPath` and `archivePath` to the same value (e.g., both 'Projects'). This causes undefined behavior - archiving a project would try to move it into its parent folder, potentially causing conflicts or weird nesting.\n\n## Reproduction\n1. Open plugin settings\n2. Set 'Projects folder' to 'Projects'\n3. Set 'Archive folder' to 'Projects'\n4. Try to archive a project\n5. Behavior is undefined/confusing\n\n## Suggested Fix\nAdd validation in one of these places:\n\n**Option A: Validate on settings save**\n```typescript\n.onChange(async (value) =\u003e {\n  const normalized = value.trim().replace(/\\/+$/, '') || 'Archive';\n  if (normalized === this.plugin.settings.projectsPath) {\n    new Notice('Archive folder cannot be the same as Projects folder');\n    return; // Don't save\n  }\n  this.plugin.settings.archivePath = normalized;\n  await this.plugin.saveSettings();\n})\n```\n\n**Option B: Validate at archive time**\nIn `archiveFolder()`, check before proceeding and show error Notice.\n\nOption A is better UX - prevents invalid state from being saved.\n\n## Files\n- src/settings.ts:48-51\n\n## Acceptance Criteria\n- [ ] Cannot save settings where projectsPath === archivePath\n- [ ] User sees clear error message explaining why\n- [ ] Existing users with invalid config see error on first archive attempt","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-06T13:13:15.157332-06:00","created_by":"zain","updated_at":"2026-01-06T13:15:31.332765-06:00","closed_at":"2026-01-06T13:15:31.332765-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-mcf","title":"Support env var for default vault path in install-dev.mjs","description":"## Problem\n`scripts/install-dev.mjs:23` hardcodes a user-specific path:\n\n```typescript\nconst DEFAULT_VAULT = '/Users/zain/test/PluginDev/TEST_Vault';\n```\n\nOther contributors would need to always use `--vault` flag.\n\n## Fix\nRead from environment variable with fallback:\n\n```typescript\nconst DEFAULT_VAULT = process.env.OBSIDIAN_TEST_VAULT || '/Users/zain/test/PluginDev/TEST_Vault';\n```\n\nContributors can then set in their shell profile:\n```bash\nexport OBSIDIAN_TEST_VAULT='/path/to/my/vault'\n```\n\n## Files\n- scripts/install-dev.mjs:23","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T13:27:50.313167-06:00","created_by":"zain","updated_at":"2026-01-06T13:33:18.072432-06:00","closed_at":"2026-01-06T13:33:18.072432-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-n44","title":"Extract test date constant and add MAX_COLLISION_ATTEMPTS test","description":"## Problem\n1. The test file uses hardcoded date '2024-03-15' in multiple assertion strings\n2. No explicit test verifying MAX_COLLISION_ATTEMPTS constant behavior\n\n## Current Code (tests/utils.test.ts)\n```typescript\nvi.setSystemTime(new Date('2024-03-15T12:00:00Z'));\n// ... later ...\nexpect(result).toBe('Archive/MyProject (Archived 2024-03-15)');\n```\n\n## Fix\n1. Extract date to a constant at the top of the describe block:\n```typescript\ndescribe('generateArchiveDestination', () =\u003e {\n  const TEST_DATE = '2024-03-15';\n  const TEST_DATE_ISO = `${TEST_DATE}T12:00:00Z`;\n\n  beforeEach(() =\u003e {\n    vi.useFakeTimers();\n    vi.setSystemTime(new Date(TEST_DATE_ISO));\n  });\n```\n\n2. Update all assertion strings to use the constant via template literals\n\n## Files\n- tests/utils.test.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-06T13:48:16.528199-06:00","created_by":"zain","updated_at":"2026-01-06T13:49:33.281378-06:00","closed_at":"2026-01-06T13:49:33.281378-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-n4a","title":"Modal constructor uses 'app: any' instead of typed App","description":"## Problem\nIn `src/main.ts:21`, the ArchiveConfirmModal constructor uses `any` type:\n\n```typescript\nconstructor(app: any, folderName: string, destPath: string, onConfirm: () =\u003e void) {\n```\n\nThis loses TypeScript type safety.\n\n## Fix\nChange to use the `App` type which is already imported at line 1:\n\n```typescript\nconstructor(app: App, folderName: string, destPath: string, onConfirm: () =\u003e void) {\n```\n\n## Files\n- src/main.ts:21","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-06T13:26:34.57726-06:00","created_by":"zain","updated_at":"2026-01-06T13:34:48.193753-06:00","closed_at":"2026-01-06T13:34:48.193753-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-oav","title":"Focus should return to actual source folder after archive","description":"## Problem\nAfter archiving an item from Areas/ or Resources/, the focus returns to Projects/ folder instead of the actual source folder the item came from.\n\n## Current Behavior\n- Archive from Projects/Foo → focus returns to Projects/ ✓\n- Archive from Areas/Bar → focus returns to Projects/ ✗\n- Archive from Resources/Baz → focus returns to Projects/ ✗\n\n## Desired Behavior\nFocus should return to the folder the item was archived FROM.\n\n## Fix Required\n\n1. Update `archiveItem()` to determine which source folder the item is in\n2. Pass source folder to `performArchive()`\n3. Rename `focusProjectsFolder()` to `focusSourceFolder(sourcePath: string)`\n4. Update the method to focus on the provided source path\n\n## Implementation\n\nIn `archiveItem()`, determine source folder:\n```typescript\nconst sourceFolders = this.getSourceFolders();\nconst sourceFolder = sourceFolders.find(src =\u003e \n  isTopLevelProjectFolder(item.path, src)\n);\n```\n\nUpdate method signature:\n```typescript\nprivate async focusSourceFolder(sourcePath: string): Promise\u003cvoid\u003e {\n  const folder = this.app.vault.getAbstractFileByPath(sourcePath);\n  // ... rest of focus logic\n}\n```\n\n## Files\n- src/main.ts","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-06T14:25:31.834166-06:00","created_by":"zain","updated_at":"2026-01-06T14:26:49.703862-06:00","closed_at":"2026-01-06T14:26:49.703862-06:00","close_reason":"Focus now returns to actual source folder"}
{"id":"para_plugin-p98","title":"Document versions.json format in CLAUDE.md","description":"## Problem\nThe `versions.json` file contains:\n```json\n{ \"1.0.0\": \"1.0.0\" }\n```\n\nThis maps plugin version to minimum Obsidian version, but this isn't documented anywhere in the project.\n\n## Context\nThis is standard Obsidian plugin convention:\n- Key: plugin version\n- Value: minimum Obsidian version required for that plugin version\n\nWhen users on older Obsidian versions try to install, Obsidian uses this to warn about compatibility.\n\n## Suggested Fix\nAdd explanation to CLAUDE.md in a 'Plugin Files' section:\n\n```markdown\n## Plugin Files\n\n### versions.json\nMaps plugin versions to minimum required Obsidian versions.\nFormat: `{ \"plugin_version\": \"min_obsidian_version\" }`\nUpdate this when releasing new versions that require newer Obsidian APIs.\n```\n\n## Files\n- CLAUDE.md\n- versions.json (reference only)","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T13:14:10.119337-06:00","created_by":"zain","updated_at":"2026-01-06T13:15:31.333916-06:00","closed_at":"2026-01-06T13:15:31.333916-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-pp4","title":"Settings text input should revert on validation failure","description":"## Problem\nIn src/settings.ts:37-45 and 55-63, when validation fails (paths match), a Notice shows but the text input retains the invalid value.\n\n## Current Code\n```typescript\n.onChange(async (value) =\u003e {\n  const normalized = value.trim().replace(/\\/+$/, '') || 'Projects';\n  if (normalized === this.plugin.settings.archivePath) {\n    new Notice('Projects folder cannot be the same as Archive folder');\n    return;  // Returns without reverting the text field\n  }\n  ...\n})\n```\n\n## Fix\nStore a reference to the text component and revert on failure:\n```typescript\n.addText((text) =\u003e\n  text\n    .setPlaceholder('Projects')\n    .setValue(this.plugin.settings.projectsPath)\n    .onChange(async (value) =\u003e {\n      const normalized = value.trim().replace(/\\/+$/, '') || 'Projects';\n      if (normalized === this.plugin.settings.archivePath) {\n        new Notice('Projects folder cannot be the same as Archive folder');\n        text.setValue(this.plugin.settings.projectsPath); // Revert\n        return;\n      }\n      ...\n    })\n)\n```\n\nDo the same for the Archive folder input.\n\n## Files\n- src/settings.ts","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T13:48:15.33429-06:00","created_by":"zain","updated_at":"2026-01-06T13:49:33.272111-06:00","closed_at":"2026-01-06T13:49:33.272111-06:00","close_reason":"Implemented by Haiku sub-agents"}
{"id":"para_plugin-qep","title":"Prevent double-click race condition on archive menu item","description":"## Problem\nIf a user right-clicks and clicks 'Archive it' multiple times quickly before the first operation completes, multiple archive attempts occur. The second attempt fails because the item has already been moved, showing an error notice.\n\n## Current Behavior\n- First click: Archives successfully\n- Second click: Fails with error 'Failed to archive: ...' (item not found)\n- No data loss, but confusing UX\n\n## Suggested Fix\nTrack in-progress archive operations and prevent concurrent archives of the same item.\n\n**Option A: Track in-progress items**\n```typescript\nprivate archivingItems = new Set\u003cstring\u003e();\n\nasync archiveItem(item: TAbstractFile): Promise\u003cvoid\u003e {\n  if (this.archivingItems.has(item.path)) {\n    return; // Already archiving this item\n  }\n  this.archivingItems.add(item.path);\n  try {\n    // ... existing archive logic\n  } finally {\n    this.archivingItems.delete(item.path);\n  }\n}\n```\n\n**Option B: Disable during operation**\nMore complex - would need to track menu item state.\n\nOption A is simpler and sufficient.\n\n## Files\n- src/main.ts:138-179 (archiveItem method)\n\n## Acceptance Criteria\n- [ ] Rapid double-clicks only archive once\n- [ ] No error shown for prevented duplicate attempts\n- [ ] Normal single-click behavior unchanged","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-06T14:16:40.766329-06:00","created_by":"zain","updated_at":"2026-01-06T14:20:12.002464-06:00","closed_at":"2026-01-06T14:20:12.002464-06:00","close_reason":"Double-click prevention implemented"}
{"id":"para_plugin-qgo","title":"Document retry logic design decision","description":"## Context\nThe retry logic in `src/main.ts:251-265` assumes all `vault.rename` failures are collisions:\n\n```typescript\nfor (let attempt = 0; attempt \u003c MAX_RENAME_RETRIES; attempt++) {\n  try {\n    await this.app.vault.rename(item, destPath);\n    break;\n  } catch (renameError) {\n    // Assumes collision, refreshes paths and retries\n  }\n}\n```\n\nThis could waste retries on non-collision errors (permissions, disk full, path too long).\n\n## Design Decision\nKeep current behavior. Rationale:\n1. 3 retries is cheap (milliseconds)\n2. Non-collision errors fail consistently anyway - all 3 retries fail, user sees error\n3. Investigating Obsidian's undocumented error types is high effort, low value\n4. The collision detection catches most cases; retry is defense-in-depth for case-insensitive filesystems\n\n## Required Fix\nAdd documentation explaining this is intentional, so future reviewers don't flag it.\n\n## Acceptance Criteria\n- [ ] Add comment block above retry loop explaining the design decision\n- [ ] Document why we don't check error types\n- [ ] Note that non-collision errors will fail all retries and surface to user","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:17:21.778473-06:00","created_by":"zain","updated_at":"2026-01-06T15:26:58.910212-06:00","closed_at":"2026-01-06T15:26:58.910212-06:00","close_reason":"Implemented via parallel sub-agents. All 43 tests pass, typecheck/lint/build all succeed.","comments":[{"id":1,"issue_id":"para_plugin-qgo","author":"zain","text":"Starting task. Found retry logic in src/main.ts:251-265. Will add comment block explaining design decision to treat all errors as potential collisions.","created_at":"2026-01-06T21:19:47Z"},{"id":4,"issue_id":"para_plugin-qgo","author":"zain","text":"DONE. Files modified: src/main.ts. Added comprehensive comment block (lines 251-259) explaining the design decision to treat all vault.rename errors as potential collisions, including rationale for not checking error types and noting that non-collision errors surface to user anyway. All tests passing, build successful.","created_at":"2026-01-06T21:20:09Z"}]}
{"id":"para_plugin-r68","title":"Add 'Archive Item' command to command palette","description":"## Feature\nAdd a unified command palette command 'Archive Item' that archives the top-level PARA item containing the currently active file.\n\n## Behavior\n- **Trigger**: Command palette → 'Archive Item'\n- **Visible/enabled when**: Active file exists AND is inside (or is) a direct child of any PARA source folder\n- **Action**: Archives the top-level item (file or folder) that is a direct child of Projects/Areas/Resources\n\n## Examples\n- Active: `Projects/MyProject/notes.md` → Archives `Projects/MyProject/` (folder)\n- Active: `Projects/todo.md` → Archives `Projects/todo.md` (file, direct child)\n- Active: `Areas/Health/habits.md` → Archives `Areas/Health/`\n- Active: `Resources/reference.md` → Archives `Resources/reference.md`\n\n## Implementation\n\nIn `src/main.ts` `onload()`, add:\n\n```typescript\nthis.addCommand({\n  id: 'archive-item',\n  name: 'Archive Item',\n  checkCallback: (checking: boolean) =\u003e {\n    const activeFile = this.app.workspace.getActiveFile();\n    if (\\!activeFile) return false;\n    \n    const topLevelItem = this.findTopLevelItem(activeFile);\n    if (\\!topLevelItem) return false;\n    \n    if (\\!checking) {\n      this.archiveItem(topLevelItem);\n    }\n    return true;\n  },\n});\n```\n\n## Helper method to add\n\n```typescript\n/**\n * Find the top-level PARA item (file or folder) for the given file.\n * Walks up the directory tree to find a direct child of any source folder.\n * If the file itself is a direct child, returns the file.\n * Returns null if file is not inside a PARA source folder.\n */\nprivate findTopLevelItem(file: TFile): TAbstractFile | null {\n  const sourceFolders = this.getSourceFolders();\n  \n  // Check if the file itself is a direct child of a source folder\n  if (sourceFolders.some(src =\u003e isTopLevelProjectFolder(file.path, src))) {\n    return file;\n  }\n  \n  // Walk up to find the top-level folder\n  let current = file.parent;\n  while (current) {\n    if (sourceFolders.some(src =\u003e isTopLevelProjectFolder(current\\!.path, src))) {\n      return current;\n    }\n    current = current.parent;\n  }\n  return null;\n}\n```\n\n## Files likely modified\n- src/main.ts (onload method, new findTopLevelItem helper)\n\n## Acceptance Criteria\n- [ ] Command appears in command palette as 'Archive Item'\n- [ ] Command disabled when no active file\n- [ ] Command disabled when active file not in PARA source folder\n- [ ] Archives containing folder when active file is nested\n- [ ] Archives the file itself when it's a direct child of source folder\n- [ ] Works for Projects, Areas, and Resources","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-06T15:12:49.645808-06:00","created_by":"zain","updated_at":"2026-01-06T15:26:58.958375-06:00","closed_at":"2026-01-06T15:26:58.958375-06:00","close_reason":"Implemented via parallel sub-agents. All 43 tests pass, typecheck/lint/build all succeed.","comments":[{"id":12,"issue_id":"para_plugin-r68","author":"zain","text":"Starting implementation. Analyzed codebase: - main.ts has context menu 'Archive it' for direct children of PARA folders - archiveItem() method handles the actual archive operation - utils.ts provides isTopLevelProjectFolder() to check if path is direct child - Need to add: command palette command + findTopLevelItem() helper method","created_at":"2026-01-06T21:25:50Z"},{"id":13,"issue_id":"para_plugin-r68","author":"zain","text":"DONE. Implementation complete. Added:\n1. Command palette command 'Archive Item' with checkCallback in onload()\n2. findTopLevelItem() helper method that walks up directory tree\n3. Verified behavior: archives file if it's direct child, or parent folder if nested\n\nAll tests pass (43/43), typecheck passes, lint passes, build succeeds.\n\nFiles modified: src/main.ts","created_at":"2026-01-06T21:26:23Z"}]}
{"id":"para_plugin-rcp","title":"Modal promise never resolves if user cancels/escapes","description":"## Problem\nIn `src/main.ts:121-126`, when confirmation modal is enabled, the Promise only resolves if user clicks 'Archive':\n\n```typescript\nif (this.settings.confirmBeforeArchive) {\n  return new Promise\u003cvoid\u003e((resolve) =\u003e {\n    new ArchiveConfirmModal(this.app, folderName, destPath, async () =\u003e {\n      await this.performArchive(folder, destPath, folderName, archivePath);\n      resolve();\n    }).open();\n  });\n}\n```\n\nIf user:\n- Presses Escape\n- Clicks outside modal\n- Clicks Cancel button\n\nThe Promise never resolves. The `archiveFolder` function hangs indefinitely (doesn't block UI since async, but semantically wrong).\n\n## Fix\nAdd onCancel callback or resolve in onClose:\n\n**Option A: Add onCancel parameter**\n```typescript\nclass ArchiveConfirmModal extends Modal {\n  private onCancel: () =\u003e void;\n  \n  constructor(app: App, folderName: string, destPath: string, onConfirm: () =\u003e void, onCancel: () =\u003e void) {\n    // ...\n    this.onCancel = onCancel;\n  }\n  \n  onClose() {\n    this.onCancel(); // Always call on close\n    this.contentEl.empty();\n  }\n}\n```\n\n**Option B: Track if confirmed**\n```typescript\nprivate confirmed = false;\n\n// In confirm handler:\nthis.confirmed = true;\nthis.onConfirm();\nthis.close();\n\n// In onClose:\nif (!this.confirmed) {\n  // User cancelled\n}\n```\n\n## Files\n- src/main.ts:16-50 (ArchiveConfirmModal class)\n- src/main.ts:121-126 (Promise creation)","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T13:26:26.963516-06:00","created_by":"zain","updated_at":"2026-01-06T13:34:12.353653-06:00","closed_at":"2026-01-06T13:34:12.353653-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-rdh","title":"Add 'Archive Project' command to command palette","description":"## Feature\nAdd a command palette command 'Archive Project' that archives the project/area/resource folder containing the currently active file.\n\n## Behavior\n- **Visible/enabled when**: Active file is inside a top-level item (direct child of any PARA source folder)\n- **Action**: Archives the entire containing folder (same as right-click 'Archive it')\n- **If not in a source folder**: Command not available\n\n## PARA Context\nCurrently the plugin only supports `projectsPath` as a source folder. Soon we'll add:\n- `areasPath` (default: 'Areas')\n- `resourcesPath` (default: 'Resources')\n\nThe implementation should be generic enough to find the top-level parent under ANY configured source folder.\n\n## Implementation\n\nIn `src/main.ts` `onload()`, add a command:\n\n```typescript\nthis.addCommand({\n  id: 'archive-project',\n  name: 'Archive Project',\n  checkCallback: (checking: boolean) =\u003e {\n    const activeFile = this.app.workspace.getActiveFile();\n    if (\\!activeFile) return false;\n    \n    const topLevelFolder = this.findTopLevelParent(activeFile);\n    if (\\!topLevelFolder) return false;\n    \n    if (\\!checking) {\n      this.archiveItem(topLevelFolder);\n    }\n    return true;\n  },\n});\n```\n\n## Helper method to add\n\n```typescript\n/**\n * Find the top-level PARA folder containing the given file.\n * Walks up the directory tree to find a direct child of any source folder.\n * Returns null if file is not inside a PARA source folder.\n */\nprivate findTopLevelParent(file: TAbstractFile): TFolder | null {\n  const sourceFolders = this.getSourceFolders();\n  \n  let current = file instanceof TFile ? file.parent : file;\n  while (current) {\n    if (sourceFolders.some(src =\u003e isTopLevelProjectFolder(current\\!.path, src))) {\n      return current;\n    }\n    current = current.parent;\n  }\n  return null;\n}\n\n/**\n * Get all configured PARA source folders that can be archived from.\n * Currently just projectsPath, but will expand to areas/resources.\n */\nprivate getSourceFolders(): string[] {\n  return [\n    normalizePath(this.settings.projectsPath),\n    // Future: add when settings exist\n    // normalizePath(this.settings.areasPath),\n    // normalizePath(this.settings.resourcesPath),\n  ];\n}\n```\n\n## Note\nThe `getSourceFolders()` helper is shared with the 'Archive File' command (para_plugin-vx8). Implement once, use in both.\n\n## Future expansion\nWhen adding areas/resources support:\n1. Add paths to `getSourceFolders()`\n2. Commands automatically work for all PARA types\n3. Consider renaming command to 'Archive Item' if it feels more generic\n\n## Files\n- src/main.ts (onload method, helper methods)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-06T13:39:18.851666-06:00","created_by":"zain","updated_at":"2026-01-06T15:12:28.312592-06:00","closed_at":"2026-01-06T15:12:28.312592-06:00","close_reason":"Merged into unified 'Archive Item' command"}
{"id":"para_plugin-uvy","title":"Extract magic number MAX_COLLISION_ATTEMPTS to named constant","description":"## Problem\nIn `src/utils.ts:100`, there's a magic number:\n\n```typescript\nif (counter \u003e 1000) {\n  throw new Error('Too many archive collisions...');\n}\n```\n\nAnd in `src/main.ts:79`:\n```typescript\nconst maxRetries = 3;\n```\n\n## Suggested Fix\nExtract to named constants at the top of each file:\n\n```typescript\n// utils.ts\nconst MAX_COLLISION_ATTEMPTS = 1000;\n\n// main.ts  \nconst MAX_RENAME_RETRIES = 3;\n```\n\nThis makes the code more self-documenting and easier to adjust if needed.\n\n## Files\n- src/utils.ts:100\n- src/main.ts:79","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-06T13:13:57.497073-06:00","created_by":"zain","updated_at":"2026-01-06T13:17:31.060544-06:00","closed_at":"2026-01-06T13:17:31.060544-06:00","close_reason":"Implemented by Haiku sub-agent"}
{"id":"para_plugin-v4b","title":"Expand test coverage for error paths and edge cases","description":"## Current State\nThe plugin has 27 unit tests covering all pure utility functions in `src/utils.ts`:\n- normalizePathPure (7 tests)\n- getParentPath (4 tests)\n- isTopLevelProjectFolder (6 tests)\n- getFolderName (4 tests)\n- generateArchiveDestination (6 tests)\n\n## Gaps\nThe following are NOT unit-tested (they involve Obsidian API and would need mocking):\n\n1. **ensureFolderExists behavior**\n   - When folder exists\n   - When folder doesn't exist (creates it)\n   - When file exists at path (should error - see para_plugin-8vt)\n\n2. **archiveFolder error paths**\n   - Archive folder creation fails\n   - Rename fails after max retries\n   - Settings have invalid paths\n\n3. **Settings persistence**\n   - Settings load correctly on plugin start\n   - Settings save correctly on change\n   - Default values applied for missing settings\n\n4. **getExistingArchivePaths**\n   - Returns correct Set of child paths\n   - Handles empty archive folder\n   - Handles non-existent archive folder\n\n## Suggested Approach\nFor Obsidian API testing, consider:\n1. Creating mock objects for `app.vault`, `app.workspace`\n2. Using dependency injection to allow test doubles\n3. Or accepting that integration testing happens manually in Obsidian\n\n## Files\n- tests/utils.test.ts (existing)\n- tests/main.test.ts (to create)\n- tests/mocks/obsidian.ts (to create if mocking)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-06T13:13:28.934879-06:00","created_by":"zain","updated_at":"2026-01-06T15:44:45.611583-06:00","closed_at":"2026-01-06T15:44:45.611583-06:00","close_reason":"Pure utility functions are well-tested (43 tests). Obsidian API methods (ensureFolderExists, archiveItem, settings persistence) require mocking undocumented APIs. The effort to build a mock framework exceeds the value; these paths are better validated through manual testing in Obsidian."}
{"id":"para_plugin-vjk","title":"Archive items into source-named subfolders within Archive","description":"## Feature\nWhen archiving, items should go into a subfolder within Archive that matches the source folder name.\n\n## Current Behavior\n- `Projects/Foo` → `Archive/Foo`\n- `Areas/Bar` → `Archive/Bar`\n- `Resources/Baz` → `Archive/Baz`\n\n## Desired Behavior\n- `Projects/Foo` → `Archive/Projects/Foo`\n- `Areas/Bar` → `Archive/Areas/Bar`\n- `Resources/Baz` → `Archive/Resources/Baz`\n\nIf user has custom folder names configured:\n- `My Projects/Foo` → `Archive/My Projects/Foo`\n- `Work Areas/Bar` → `Archive/Work Areas/Bar`\n\n## Implementation\n\n### 1. Update `archiveItem()` in `src/main.ts`\n\nAfter determining the sourceFolder, extract just the folder name:\n```typescript\nconst sourceFolderName = getItemName(sourceFolder); // e.g., 'Projects' from 'Projects' or 'My Projects' from 'path/to/My Projects'\n```\n\n### 2. Update destination path generation\n\nChange the archive destination from:\n```typescript\nconst destPath = generateArchiveDestination(archivePath, itemName, existingPaths);\n```\n\nTo include the source subfolder:\n```typescript\nconst archiveSubfolder = `${archivePath}/${sourceFolderName}`;\nawait this.ensureFolderExists(archiveSubfolder);\nconst existingPaths = this.getExistingArchivePaths(archiveSubfolder);\nconst destPath = generateArchiveDestination(archiveSubfolder, itemName, existingPaths);\n```\n\n### 3. Update collision detection\n\nThe `getExistingArchivePaths()` call should now check the subfolder, not the root Archive folder.\n\n### 4. Update confirmation dialog\n\nThe displayed destination path will automatically reflect the new structure since it uses `destPath`.\n\n## Example Result\nWith default settings:\n```\nArchive/\n├── Projects/\n│   ├── OldProject1/\n│   └── OldProject2/\n├── Areas/\n│   └── OldArea1/\n└── Resources/\n    └── OldResource1/\n```\n\n## Files\n- src/main.ts (archiveItem method, destination path logic)\n\n## Acceptance Criteria\n- [ ] Items from Projects go to Archive/Projects/\n- [ ] Items from Areas go to Archive/Areas/\n- [ ] Items from Resources go to Archive/Resources/\n- [ ] Custom folder names are preserved (e.g., 'My Projects' → 'Archive/My Projects/')\n- [ ] Subfolders are created automatically if they don't exist\n- [ ] Collision detection works within each subfolder independently","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-06T14:54:49.646169-06:00","created_by":"zain","updated_at":"2026-01-06T15:26:58.947234-06:00","closed_at":"2026-01-06T15:26:58.947234-06:00","close_reason":"Implemented via parallel sub-agents. All 43 tests pass, typecheck/lint/build all succeed.","comments":[{"id":10,"issue_id":"para_plugin-vjk","author":"zain","text":"Starting implementation. Analyzed codebase structure. Will modify archiveItem() method in src/main.ts to include source folder name in archive destination path.","created_at":"2026-01-06T21:24:25Z"},{"id":11,"issue_id":"para_plugin-vjk","author":"zain","text":"DONE. Files modified: src/main.ts (archiveItem method and performArchive method). Implementation includes:\n1. Extract source folder name using getItemName(sourceFolder)\n2. Create archiveSubfolder path combining archivePath + sourceFolderName\n3. Ensure archiveSubfolder exists with ensureFolderExists()\n4. Get collision detection from archiveSubfolder instead of root archive\n5. Pass archiveSubfolder to generateArchiveDestination() and performArchive()\n6. Updated performArchive() signature to use archiveSubfolder instead of archivePath\n\nAll tests pass (43/43), typecheck passes, linting passes, build succeeds.\n\nFeature now creates proper subfolders:\n- Projects/Foo -\u003e Archive/Projects/Foo\n- Areas/Bar -\u003e Archive/Areas/Bar\n- Resources/Baz -\u003e Archive/Resources/Baz\n- Custom names preserved: My Projects/Foo -\u003e Archive/My Projects/Foo","created_at":"2026-01-06T21:25:04Z"}]}
{"id":"para_plugin-vx8","title":"Add 'Archive File' command to command palette","description":"## Feature\nAdd a command palette command 'Archive File' that archives only the currently active file.\n\n## Behavior\n- **Visible/enabled when**: There is an active file AND it's a direct child of a PARA source folder\n- **Action**: Archives just that file to archivePath\n- **If no active file or not in a source folder**: Command not available\n\n## PARA Context\nCurrently the plugin only supports `projectsPath` as a source folder. Soon we'll add:\n- `areasPath` (default: 'Areas')\n- `resourcesPath` (default: 'Resources')\n\nThe implementation should be generic enough to check if the active file is a direct child of ANY configured source folder.\n\n## Implementation\n\nIn `src/main.ts` `onload()`, add a command:\n\n```typescript\nthis.addCommand({\n  id: 'archive-file',\n  name: 'Archive File',\n  checkCallback: (checking: boolean) =\u003e {\n    const activeFile = this.app.workspace.getActiveFile();\n    if (!activeFile) return false;\n    \n    // Check if active file is direct child of any PARA source folder\n    const sourceFolders = this.getSourceFolders(); // Returns array of normalized paths\n    const isInSourceFolder = sourceFolders.some(sourcePath =\u003e \n      isTopLevelProjectFolder(activeFile.path, sourcePath)\n    );\n    \n    if (!isInSourceFolder) {\n      return false;\n    }\n    \n    if (!checking) {\n      this.archiveItem(activeFile);\n    }\n    return true;\n  },\n});\n```\n\n## Helper method to add\n\n```typescript\n/**\n * Get all configured PARA source folders that can be archived from.\n * Currently just projectsPath, but will expand to areas/resources.\n */\nprivate getSourceFolders(): string[] {\n  return [\n    normalizePath(this.settings.projectsPath),\n    // Future: add when settings exist\n    // normalizePath(this.settings.areasPath),\n    // normalizePath(this.settings.resourcesPath),\n  ];\n}\n```\n\n## Future expansion\nWhen adding areas/resources support:\n1. Add `areasPath` and `resourcesPath` to settings interface\n2. Add them to `getSourceFolders()` return array\n3. Update context menu registration to also show on direct children of areas/resources\n4. Commands will automatically work due to generic implementation\n\n## Files\n- src/main.ts (onload method, new helper method)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-06T13:39:30.351214-06:00","created_by":"zain","updated_at":"2026-01-06T15:12:28.314371-06:00","closed_at":"2026-01-06T15:12:28.314371-06:00","close_reason":"Merged into unified 'Archive Item' command"}
{"id":"para_plugin-w6b","title":"Fix misleading settings description for focus behavior","description":"## Problem\nSettings UI in `src/settings.ts:150-152` says:\n- Name: \"Focus Projects folder after archive\"\n- Desc: \"Return focus to the Projects folder in the file explorer after archiving\"\n\nBut the actual behavior (in `src/main.ts:275-277`) focuses on **whichever source folder the item came from** (Projects, Areas, OR Resources).\n\n## Required Fix\nUpdate the setting name and description to accurately reflect behavior:\n- Name: \"Focus source folder after archive\"\n- Desc: \"Return focus to the source folder (Projects, Areas, or Resources) after archiving\"\n\n## Acceptance Criteria\n- [ ] Update setting name in `src/settings.ts`\n- [ ] Update setting description\n- [ ] Verify no other documentation references the old behavior","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-06T15:17:17.201518-06:00","created_by":"zain","updated_at":"2026-01-06T15:26:58.897142-06:00","closed_at":"2026-01-06T15:26:58.897142-06:00","close_reason":"Implemented via parallel sub-agents. All 43 tests pass, typecheck/lint/build all succeed.","comments":[{"id":2,"issue_id":"para_plugin-w6b","author":"zain","text":"Starting task: Fixing misleading settings description for focus behavior. Found settings at lines 150-152 that need updating.","created_at":"2026-01-06T21:19:47Z"},{"id":3,"issue_id":"para_plugin-w6b","author":"zain","text":"Verified behavior: main.ts:275-277 shows focusAfterArchive focuses on sourceFolder (any of Projects, Areas, or Resources). Found 4 references to update: src/settings.ts:150-152, README.md lines 10, 33, and 140.","created_at":"2026-01-06T21:20:01Z"},{"id":5,"issue_id":"para_plugin-w6b","author":"zain","text":"DONE. Files modified: src/settings.ts (lines 150-152), README.md (lines 10, 33, 140). All tests pass (28/28). Updated settings UI name and description to accurately reflect focus behavior focuses on source folder (Projects, Areas, or Resources) not just Projects. Updated all related documentation.","created_at":"2026-01-06T21:20:20Z"}]}
